(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    122108,       2816]
NotebookOptionsPosition[    114798,       2712]
NotebookOutlinePosition[    115133,       2727]
CellTagsIndexPosition[    115090,       2724]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
   "******)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"rlbarnett", " ", "c3149416", " ", "191016"}], " ", "*)"}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Expansion", " ", "of", " ", "full", " ", "ponderomotive", " ", "force", 
     " ", "term", " ", "from", " ", 
     RowBox[{"J", ".", " ", "Myra"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Phys", ".", " ", "Plasmas"}], " ", "2004"}], ")"}]}], ",", 
    " ", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"1", "/", "2"}], " ", "Real", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"i", "/", "om"}], ")"}], "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Del]", "E"}], "*"}], " ", ")"}], "J"}], " ", "-", " ", 
          RowBox[{"\[Del]", ".", 
           RowBox[{"(", 
            RowBox[{"JE", "*"}], " ", ")"}]}]}], "]"}], " ", "-", " ", 
        RowBox[{"\[Del]", ".", 
         RowBox[{"(", 
          RowBox[{"nmuu", "*"}], " ", ")"}]}]}], "}"}], "."}], 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "*", " ", "denotes", " ", 
     "the", " ", "complex", " ", "conjugate"}], ",", " ", 
    RowBox[{
    "E", " ", "J", " ", "and", " ", "u", " ", "are", " ", "all", " ", 
     "vectors", " ", "and", " ", "all", " ", "are", " ", "functions", " ", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"of", " ", "[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}], ".", " ", "u"}], " ", "is", 
     " ", "calculated", " ", "from", " ", "the", " ", "fast", " ", "time", 
     " ", "scale", " ", "equation", " ", "of", " ", "motion"}], ",", " ", 
    "\[IndentingNewLine]", 
    RowBox[{"J", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"n", "*", "q", "*", "u"}], "\[IndentingNewLine]", "-", 
       RowBox[{"i", "*", "om", "*", "u"}], " ", "-", " ", 
       RowBox[{"u", " ", "\[Cross]", " ", "OMz"}]}], " ", "=", " ", "a"}]}], 
    ",", " ", 
    RowBox[{"a", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q", "/", "m"}], ")"}], "*", 
       RowBox[{"E", ".", "  ", "OMz"}]}], " ", "=", " ", 
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", 
        RowBox[{"qB", "/", "m"}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**",
     "**", "**", "**", "**", "**", "**", "**", "**", "**", "**", "**"}], 
   "******)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"excluded", "=", 
   RowBox[{"\"\<ExcludedFunctions\>\"", "/.", 
    RowBox[{"(", 
     RowBox[{"\"\<DifferentiationOptions\>\"", "/.", 
      RowBox[{"SystemOptions", "[", "\"\<DifferentiationOptions\>\"", "]"}]}],
      ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.780097699267068*^9, 3.780097814288176*^9}, {
   3.7801014264846487`*^9, 3.780101461201807*^9}, {3.7801017071001797`*^9, 
   3.780101708992799*^9}, {3.7801026885387917`*^9, 3.78010274278898*^9}, {
   3.780165457491522*^9, 3.780165906011286*^9}, {3.78016625072495*^9, 
   3.780166386668902*^9}, 3.7801679158052483`*^9, {3.7802615750856457`*^9, 
   3.780261582104353*^9}, {3.780261623191489*^9, 3.7802616351647387`*^9}, {
   3.780337978688126*^9, 3.780337985944168*^9}, {3.780338024418487*^9, 
   3.7803380275137157`*^9}, {3.780353634079013*^9, 3.780353688829859*^9}, {
   3.7803537190517817`*^9, 3.7803537558468447`*^9}, {3.7810445816583767`*^9, 
   3.781044593065304*^9}},
 CellLabel->
  "In[3276]:=",ExpressionUUID->"7eaf9c2a-9f68-4c56-807e-f3e67ea9f3a6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Conjugate", ",", "Element", ",", "Exists", ",", "ForAll", ",", "Greater", 
   ",", "GreaterEqual", ",", "Hold", ",", "HoldComplete", ",", "Implies", ",",
    "Inequality", ",", "Less", ",", "LessEqual", ",", "Nand", ",", "Negative",
    ",", "NonNegative", ",", "NonPositive", ",", "Nor", ",", "Not", ",", 
   "Positive", ",", "Replace", ",", "ReplaceAll", ",", "ReplaceRepeated", ",",
    "Unequal", ",", "Xor"}], "}"}]], "Output",
 CellChangeTimes->{
  3.780262367136222*^9, {3.780262891436253*^9, 3.780262900864737*^9}, 
   3.780263025236493*^9, 3.7802671952527447`*^9, 3.7803622243045263`*^9, 
   3.780362389676996*^9, {3.780362466037726*^9, 3.780362494405781*^9}, 
   3.780362541810095*^9, 3.780363061174388*^9, 3.780363139432482*^9, 
   3.780363205665804*^9, 3.78036346542899*^9, 3.780363547515459*^9, 
   3.780363650909985*^9, 3.780698460930312*^9, 3.780700820526197*^9, {
   3.780700896341198*^9, 3.7807009362784977`*^9}, {3.780858440996005*^9, 
   3.780858469308937*^9}, 3.780859842652808*^9, {3.780859914203321*^9, 
   3.780859921189786*^9}, 3.780859967149007*^9, {3.780860215952857*^9, 
   3.780860255080439*^9}, 3.780860297514295*^9, {3.780860362715301*^9, 
   3.780860382588791*^9}, 3.7808606189313393`*^9, 3.780860689150765*^9, 
   3.7808616721846457`*^9, 3.7808689182855797`*^9, {3.780869450929784*^9, 
   3.780869476845139*^9}, 3.7808716958802137`*^9, {3.7808717400591183`*^9, 
   3.78087181438264*^9}, 3.780873915067852*^9, 3.780874058159575*^9, 
   3.780874466403569*^9, 3.780874919953239*^9, 3.780875372114333*^9, {
   3.78087547149111*^9, 3.780875525276322*^9}, 3.780875604669815*^9, 
   3.7808757757677717`*^9, 3.7808759911248713`*^9, 3.7808760958758917`*^9, 
   3.780876165644504*^9, 3.7809415779734993`*^9, 3.780941609616276*^9, 
   3.780950910938919*^9, {3.7809534564825907`*^9, 3.780953471777964*^9}, 
   3.780967909198474*^9, 3.780968027055024*^9, 3.7809680715874777`*^9, 
   3.780968107631772*^9, {3.780968246491708*^9, 3.7809682671572037`*^9}, 
   3.780968371368788*^9, 3.780968456616735*^9, 3.7809686022356577`*^9, {
   3.781043074081274*^9, 3.7810430839010353`*^9}, 3.781043143555541*^9, 
   3.781043191544279*^9, 3.781043273787415*^9, 3.781043331092033*^9, 
   3.78104339597528*^9, 3.781043430524246*^9, 3.781043515748798*^9, {
   3.781043603123006*^9, 3.7810436091256447`*^9}, 3.781043753526495*^9, 
   3.7810438223316603`*^9, 3.781043930216402*^9, 3.781044495259688*^9, 
   3.7812927493716917`*^9, 3.781292821336074*^9},
 CellLabel->
  "Out[3276]=",ExpressionUUID->"e9e11d67-3cd2-4c4c-aa57-9222d252d6c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Hold", ",", "HoldComplete", ",", "Less", ",", "LessEqual", ",", "Greater", 
   ",", "GreaterEqual", ",", "Inequality", ",", "Unequal", ",", "Nand", ",", 
   "Nor", ",", "Xor", ",", "Not", ",", "Element", ",", "Exists", ",", 
   "ForAll", ",", "Implies", ",", "Positive", ",", "Negative", ",", 
   "NonPositive", ",", "NonNegative", ",", "Replace", ",", "ReplaceAll", ",", 
   "ReplaceRepeated"}], "}"}]], "Input",
 CellChangeTimes->{3.780261736232689*^9},
 CellLabel->
  "In[3277]:=",ExpressionUUID->"9c880cf5-f9a8-49f6-a8b6-5e172fd8bb9d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "Hold", ",", "HoldComplete", ",", "Less", ",", "LessEqual", ",", "Greater", 
   ",", "GreaterEqual", ",", "Inequality", ",", "Unequal", ",", "Nand", ",", 
   "Nor", ",", "Xor", ",", "Not", ",", "Element", ",", "Exists", ",", 
   "ForAll", ",", "Implies", ",", "Positive", ",", "Negative", ",", 
   "NonPositive", ",", "NonNegative", ",", "Replace", ",", "ReplaceAll", ",", 
   "ReplaceRepeated"}], "}"}]], "Output",
 CellChangeTimes->{
  3.780261736299922*^9, 3.7802623672377768`*^9, {3.780262891521892*^9, 
   3.780262900958836*^9}, 3.780263025326995*^9, 3.7802671954692707`*^9, 
   3.780362224395096*^9, 3.780362389800193*^9, {3.7803624661338053`*^9, 
   3.780362494519588*^9}, 3.780362541919889*^9, 3.780363061255163*^9, 
   3.780363139537731*^9, 3.7803632057588243`*^9, 3.780363465600349*^9, 
   3.780363547583103*^9, 3.780363650990082*^9, 3.780698461037116*^9, 
   3.780700820645555*^9, {3.780700896431596*^9, 3.780700936367466*^9}, {
   3.780858441062653*^9, 3.7808584693969*^9}, 3.7808598427507133`*^9, {
   3.780859914276496*^9, 3.780859921267757*^9}, 3.780859967249402*^9, {
   3.7808602160506897`*^9, 3.7808602551513853`*^9}, 3.780860298028652*^9, {
   3.780860362873171*^9, 3.780860382698103*^9}, 3.780860619023671*^9, 
   3.780860689232736*^9, 3.780861672269598*^9, 3.780868918401002*^9, {
   3.780869451007471*^9, 3.7808694769416122`*^9}, 3.7808716959740677`*^9, {
   3.780871740141428*^9, 3.7808718144962263`*^9}, 3.780873915166608*^9, 
   3.780874058241968*^9, 3.780874466511135*^9, 3.780874920086171*^9, 
   3.780875372212042*^9, {3.780875471617408*^9, 3.780875525359768*^9}, 
   3.780875604839251*^9, 3.7808757758606863`*^9, 3.780875991215355*^9, 
   3.780876095959158*^9, 3.780876165745063*^9, 3.780941578040749*^9, 
   3.780941609700235*^9, 3.780950911051759*^9, {3.780953456562005*^9, 
   3.78095347186825*^9}, 3.780967909315736*^9, 3.780968027132773*^9, 
   3.7809680716754913`*^9, 3.780968107765017*^9, {3.780968246592778*^9, 
   3.780968267242976*^9}, 3.780968371454193*^9, 3.7809684566962852`*^9, 
   3.780968602334475*^9, {3.7810430741916656`*^9, 3.7810430840142307`*^9}, 
   3.7810431436582937`*^9, 3.7810431916842337`*^9, 3.781043273904334*^9, 
   3.781043331220656*^9, 3.781043396106846*^9, 3.7810434306245537`*^9, 
   3.781043515865952*^9, {3.7810436032547503`*^9, 3.7810436092385283`*^9}, 
   3.781043753633355*^9, 3.781043822468143*^9, 3.7810439303141613`*^9, 
   3.781044495379589*^9, 3.781292749519882*^9, 3.781292821413458*^9},
 CellLabel->
  "Out[3277]=",ExpressionUUID->"d3a6ee5c-e5d9-40e2-94ed-230624306695"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SetSystemOptions", "[", 
  RowBox[{"\"\<DifferentiationOptions\>\"", "\[Rule]", 
   RowBox[{"\"\<ExcludedFunctions\>\"", "\[Rule]", 
    RowBox[{"Union", "[", 
     RowBox[{"excluded", ",", 
      RowBox[{"{", "Conjugate", "}"}]}], "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.780261667150573*^9, 3.7802616751102123`*^9}},
 CellLabel->
  "In[3278]:=",ExpressionUUID->"d4fbffe0-5838-47d6-b9da-91f57e12328e"],

Cell[BoxData[
 RowBox[{"\<\"DifferentiationOptions\"\>", "\[Rule]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"\<\"AlwaysThreadGradients\"\>", "\[Rule]", "False"}], ",", 
    RowBox[{"\<\"DifferentiateHeads\"\>", "\[Rule]", "True"}], ",", 
    RowBox[{"\<\"DifferentiateIteratorIndexed\"\>", "\[Rule]", "True"}], ",", 
    
    RowBox[{"\<\"DirectHighDerivatives\"\>", "\[Rule]", "True"}], ",", 
    RowBox[{"\<\"DirectHighDerivativeThreshold\"\>", "\[Rule]", "10"}], ",", 
    RowBox[{"\<\"ExcludedFunctions\"\>", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "Conjugate", ",", "Element", ",", "Exists", ",", "ForAll", ",", 
       "Greater", ",", "GreaterEqual", ",", "Hold", ",", "HoldComplete", ",", 
       "Implies", ",", "Inequality", ",", "Less", ",", "LessEqual", ",", 
       "Nand", ",", "Negative", ",", "NonNegative", ",", "NonPositive", ",", 
       "Nor", ",", "Not", ",", "Positive", ",", "Replace", ",", "ReplaceAll", 
       ",", "ReplaceRepeated", ",", "Unequal", ",", "Xor"}], "}"}]}], ",", 
    RowBox[{"\<\"ExitOnFailure\"\>", "\[Rule]", "False"}], ",", 
    RowBox[{"\<\"HighDerivativeMaxTerms\"\>", "\[Rule]", "1000"}], ",", 
    RowBox[{"\<\"SymbolicAutomaticDifferentiation\"\>", "\[Rule]", 
     "False"}]}], "}"}]}]], "Output",
 CellChangeTimes->{
  3.7802616768016148`*^9, 3.780261737827129*^9, 3.780262367250709*^9, {
   3.780262891533436*^9, 3.7802629009719477`*^9}, 3.780263025337654*^9, 
   3.780267195516433*^9, 3.780362224408904*^9, 3.780362389819666*^9, {
   3.780362466146093*^9, 3.7803624945372667`*^9}, 3.780362541934166*^9, 
   3.780363061268261*^9, 3.7803631395498238`*^9, 3.780363205772789*^9, 
   3.7803634656205187`*^9, 3.780363547596141*^9, 3.7803636510036182`*^9, 
   3.7806984611021214`*^9, 3.780700820665532*^9, {3.780700896445256*^9, 
   3.780700936378827*^9}, {3.780858441108796*^9, 3.780858469417441*^9}, 
   3.780859842766322*^9, {3.780859914289476*^9, 3.7808599212817907`*^9}, 
   3.780859967321095*^9, {3.780860216064797*^9, 3.780860255166397*^9}, 
   3.780860298058791*^9, {3.780860362887321*^9, 3.7808603827078238`*^9}, 
   3.7808606190348787`*^9, 3.780860689244379*^9, 3.780861672282399*^9, 
   3.780868918413515*^9, {3.780869451018198*^9, 3.7808694769513474`*^9}, 
   3.78087169598759*^9, {3.780871740154799*^9, 3.78087181451477*^9}, 
   3.7808739152310047`*^9, 3.780874058255149*^9, 3.780874466530795*^9, 
   3.780874920100038*^9, 3.780875372222158*^9, {3.7808754716369762`*^9, 
   3.780875525371057*^9}, 3.780875604853611*^9, 3.78087577587563*^9, 
   3.7808759912284937`*^9, 3.780876095972743*^9, 3.780876165835623*^9, 
   3.780941578054718*^9, 3.7809416097129173`*^9, 3.780950911066526*^9, {
   3.780953456575308*^9, 3.780953471880495*^9}, 3.780967909353318*^9, 
   3.780968027145013*^9, 3.7809680716860847`*^9, 3.780968107783148*^9, {
   3.780968246609124*^9, 3.7809682672553263`*^9}, 3.780968371466648*^9, 
   3.780968456709453*^9, 3.78096860234752*^9, {3.781043074212007*^9, 
   3.781043084031289*^9}, 3.781043143674779*^9, 3.781043191706167*^9, 
   3.781043273920866*^9, 3.781043331237494*^9, 3.781043396122752*^9, 
   3.781043430640292*^9, 3.781043515884427*^9, {3.7810436032707233`*^9, 
   3.781043609254571*^9}, 3.781043753650549*^9, 3.78104382248586*^9, 
   3.781043930332218*^9, 3.781044495471817*^9, 3.781292749601898*^9, 
   3.781292821432357*^9},
 CellLabel->
  "Out[3278]=",ExpressionUUID->"5505ae73-ab95-496d-8ab0-8aae14676f92"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Unprotect", "[", "Conjugate", "]"}], ";"}], "\n", 
 RowBox[{"Conjugate", "/:", 
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"Conjugate", "[", "f_", "]"}], ",", "x__"}], "]"}], ":=", 
  RowBox[{"Conjugate", "[", 
   RowBox[{"D", "[", 
    RowBox[{"f", ",", "x"}], "]"}], "]"}]}], "\n", 
 RowBox[{
  RowBox[{"Protect", "[", "Conjugate", "]"}], ";"}]}], "Input",
 CellChangeTimes->{3.780261717282071*^9},
 CellLabel->
  "In[3279]:=",ExpressionUUID->"c3dd8c2e-a7cd-4af1-8ddc-0f154bfeea1d"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Define", " ", "vectors", " ", "for", " ", "E1"}], ",", " ", "J1",
     ",", " ", 
    RowBox[{"and", " ", 
     RowBox[{"u1", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"e1", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"e1x", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
       RowBox[{"e1y", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
       RowBox[{"e1z", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"j1", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"j1x", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
       RowBox[{"j1y", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
       RowBox[{"u1z", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"u1", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"u1x", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
       RowBox[{"u1y", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}], ",", 
       RowBox[{"j1z", "[", 
        RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.780261626405116*^9, {3.7803623826264467`*^9, 3.780362384228466*^9}, {
   3.780362462376525*^9, 3.780362462510467*^9}, {3.780362518095296*^9, 
   3.780362524325124*^9}, {3.780363135132554*^9, 3.780363135556736*^9}, {
   3.78036344968708*^9, 3.780363461179439*^9}, {3.780698438157115*^9, 
   3.780698440074738*^9}, {3.78070081526187*^9, 3.7807008174004602`*^9}, {
   3.780700880822801*^9, 3.780700893144024*^9}, {3.780858239585268*^9, 
   3.780858270763269*^9}, {3.7808597911826487`*^9, 3.780859831137763*^9}, {
   3.7808616406065063`*^9, 3.780861664966851*^9}, {3.780869245571969*^9, 
   3.780869254827961*^9}, {3.7808694678000593`*^9, 3.780869473893565*^9}, {
   3.780871734346607*^9, 3.7808717549195232`*^9}, {3.780873962903063*^9, 
   3.780873966670617*^9}, {3.780874378055415*^9, 3.780874391989688*^9}, {
   3.780874901007654*^9, 3.7808749111407433`*^9}, {3.780875360030723*^9, 
   3.780875368533648*^9}, {3.780875406851069*^9, 3.780875464124811*^9}, {
   3.7808755744033127`*^9, 3.780875592798831*^9}, {3.780875980626144*^9, 
   3.780875988123804*^9}, {3.780876086317048*^9, 3.780876086943214*^9}, {
   3.781043058258321*^9, 3.7810430806327457`*^9}, {3.781043317335664*^9, 
   3.7810433281884212`*^9}, {3.781043377464664*^9, 3.781043393349409*^9}, {
   3.7810434869788227`*^9, 3.781043606512167*^9}, {3.7810437072635183`*^9, 
   3.7810437365384073`*^9}, {3.781043819256918*^9, 3.7810438193884974`*^9}},
 CellLabel->
  "In[3282]:=",ExpressionUUID->"3976b533-f7a2-43a4-8749-dc73a2d5215b"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Calculate", " ", 
   RowBox[{"\[Del]", "E"}], "*", 
   RowBox[{".", " ", "Note"}], " ", "that", " ", "the", " ", "gradient", " ", 
   "of", " ", "a", " ", "vector", " ", "is", " ", "a", " ", "rank", " ", "2", 
   " ", 
   RowBox[{"tensor", "."}]}], " ", "*)"}]], "Input",
 CellLabel->
  "In[3285]:=",ExpressionUUID->"94ab76cc-d1be-4158-baa6-98e4a552c4a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"gradec", " ", "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{"Grad", "[", 
     RowBox[{
      RowBox[{"Conjugate", "[", "e1", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.78009787528985*^9, 3.780097886317294*^9}, {
   3.7801016996898947`*^9, 3.7801017182700863`*^9}, {3.780101858422851*^9, 
   3.78010187536477*^9}, {3.7801019370562267`*^9, 3.780101951501213*^9}, {
   3.780102194983438*^9, 3.78010222442692*^9}, {3.780103795326853*^9, 
   3.78010382147633*^9}, {3.7801040518383217`*^9, 3.780104054727927*^9}, {
   3.7801652292858877`*^9, 3.780165233135696*^9}, {3.78025593591405*^9, 
   3.780255939662629*^9}, {3.7802560399439583`*^9, 3.7802560411249933`*^9}, {
   3.780260646676031*^9, 3.780260652177046*^9}, {3.7802606927713223`*^9, 
   3.780260693371122*^9}, {3.780260812083888*^9, 3.780260813840124*^9}, {
   3.780261728581607*^9, 3.7802617327700644`*^9}, {3.780363198785194*^9, 
   3.780363202339219*^9}, {3.780700911651741*^9, 3.780700933018694*^9}, {
   3.780860206581271*^9, 3.7808602079221277`*^9}, {3.780860351661565*^9, 
   3.7808603786575127`*^9}, 3.7808716789018497`*^9, {3.780871757012698*^9, 
   3.780871757481251*^9}, {3.780871811128022*^9, 3.780871831138762*^9}, {
   3.7808739688111773`*^9, 3.780873968988956*^9}, {3.780874403564377*^9, 
   3.780874404022582*^9}, 3.7809521581033792`*^9, {3.7809522224601603`*^9, 
   3.780952222878422*^9}, {3.7809685983264837`*^9, 3.780968613716344*^9}, 
   3.781044492383774*^9},
 CellLabel->
  "In[3286]:=",ExpressionUUID->"93cc711f-79f2-4ec3-9237-a14f23421afe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Calculate", " ", "first", " ", "term", " ", "in", " ", "expression"}], 
    ",", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Del]", "E"}], "*"}], " ", ")"}], "J"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ClearAll", "[", "term1", "]"}]}]], "Input",
 CellChangeTimes->{{3.780099243314905*^9, 3.7800992461053247`*^9}, {
  3.780166341828182*^9, 3.780166396732349*^9}},
 CellLabel->
  "In[3287]:=",ExpressionUUID->"535a0ab3-2ccf-4273-945b-84117760b7ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"term1", "=", 
   RowBox[{"Dot", "[", 
    RowBox[{"gradec", ",", "j1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7800992505388937`*^9, 3.7800992671022863`*^9}, {
  3.781044485588832*^9, 3.781044486394513*^9}},
 CellLabel->
  "In[3288]:=",ExpressionUUID->"1ef227e6-06be-40a9-b7b0-8bd7df6d9c69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Substitute", " ", "for", " ", "J"}], "=", "nqu"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"term1", "=", 
    RowBox[{"term1", "/.", 
     RowBox[{
      RowBox[{"j1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
      RowBox[{"n", "*", "q", "*", 
       RowBox[{"u1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.780099271433713*^9, 3.780099314218853*^9}, 
   3.7800993712319717`*^9, {3.780099535311055*^9, 3.780099536216919*^9}, {
   3.7801013026679163`*^9, 3.780101304070629*^9}, {3.780102096312133*^9, 
   3.78010209742726*^9}, 3.780165238332301*^9, {3.7801664006215754`*^9, 
   3.7801664171453943`*^9}, {3.7803625977938433`*^9, 
   3.7803625983261127`*^9}, {3.7803627045335827`*^9, 3.780362706488227*^9}, {
   3.7803631116735373`*^9, 3.780363112125823*^9}},
 CellLabel->
  "In[3289]:=",ExpressionUUID->"44bbbc6c-d9fd-4e3f-b056-c2820a3e5dd4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"term1", "=", 
   RowBox[{"term1", "/.", 
    RowBox[{
     RowBox[{"j1", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
     RowBox[{"n", "*", "q", "*", 
      RowBox[{"u1", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.780099386244399*^9, 3.780099388286327*^9}, {
   3.7800995393355503`*^9, 3.780099540057132*^9}, {3.780101313245487*^9, 
   3.780101314557561*^9}, {3.780102112273184*^9, 3.7801021135993853`*^9}, 
   3.78016523952026*^9, {3.780167549841918*^9, 3.780167554733828*^9}, {
   3.78036260118819*^9, 3.780362601667437*^9}, {3.780362707842907*^9, 
   3.7803627099462767`*^9}, {3.780363114750986*^9, 3.780363116417712*^9}},
 CellLabel->
  "In[3290]:=",ExpressionUUID->"1909b70a-37c9-49c2-b8d7-5302a24a9802"],

Cell[BoxData[
 RowBox[{
  RowBox[{"term1", "=", 
   RowBox[{"term1", "/.", 
    RowBox[{
     RowBox[{"j1", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
     RowBox[{"n", "*", "q", "*", 
      RowBox[{"u1", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.780099519434269*^9, 3.780099544152597*^9}, {
   3.78010131773834*^9, 3.780101319156993*^9}, {3.780102116427829*^9, 
   3.7801021177515297`*^9}, 3.7801652407524223`*^9, {3.7803627113190203`*^9, 
   3.78036271366121*^9}, {3.78036311863023*^9, 3.7803631191763*^9}},
 CellLabel->
  "In[3291]:=",ExpressionUUID->"98a40c7b-a283-40c5-90d0-a8e3177dccd3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Print", " ", "result", " ", "and", " ", "check", " ", 
    RowBox[{"dimensions", ".", " ", "Should"}], " ", "be", " ", "a", " ", 
    RowBox[{"vector", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"term1", ";"}], "\[IndentingNewLine]", 
   RowBox[{"Dimensions", "[", "term1", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7801028575604486`*^9, 3.780102861021308*^9}, 
   3.780103847429529*^9, {3.780165244317603*^9, 3.780165244867579*^9}, {
   3.780166428984366*^9, 3.780166442270767*^9}, {3.78104447649021*^9, 
   3.781044498629652*^9}},
 CellLabel->
  "In[3292]:=",ExpressionUUID->"61a3ef56-99d5-4128-b306-9478a9bd9bfc"],

Cell[BoxData[
 RowBox[{"{", "3", "}"}]], "Output",
 CellChangeTimes->{
  3.780102861580147*^9, {3.7801038494078083`*^9, 3.780103859202441*^9}, 
   3.780165269092909*^9, 3.7801675592424307`*^9, 3.780254108679968*^9, 
   3.780255514000041*^9, 3.780255945512937*^9, 3.780256044376503*^9, 
   3.780256122292347*^9, 3.780256497607408*^9, 3.780256616736931*^9, 
   3.7802566809728603`*^9, 3.780260346274805*^9, 3.780261783248455*^9, 
   3.780262367513142*^9, {3.780262891772644*^9, 3.780262901266822*^9}, 
   3.780263025628791*^9, 3.780267195787512*^9, 3.7803622246928177`*^9, 
   3.780362390292117*^9, {3.780362466436522*^9, 3.7803624947664633`*^9}, 
   3.780362542253788*^9, 3.780363061485639*^9, {3.7803631240126457`*^9, 
   3.780363139911914*^9}, 3.78036320610594*^9, 3.780363466078211*^9, 
   3.7803635477800407`*^9, 3.7803636512103148`*^9, 3.780698461382511*^9, 
   3.780700821093804*^9, {3.78070089679595*^9, 3.780700936711005*^9}, {
   3.7808584413439827`*^9, 3.78085846967033*^9}, 3.780859843099937*^9, {
   3.780859914539089*^9, 3.780859921494035*^9}, 3.780859967544714*^9, {
   3.780860216373786*^9, 3.7808602553962307`*^9}, 3.780860299142345*^9, {
   3.7808603631947536`*^9, 3.780860383018429*^9}, 3.780860619291852*^9, 
   3.780860689474215*^9, 3.780861672584609*^9, 3.7808689186552134`*^9, {
   3.780869451231112*^9, 3.780869477277155*^9}, 3.780871696252927*^9, {
   3.780871740532401*^9, 3.780871815022702*^9}, 3.780873915486949*^9, 
   3.780874058544907*^9, 3.78087446692306*^9, 3.7808749205885897`*^9, 
   3.78087537259826*^9, {3.780875472188425*^9, 3.7808755256440783`*^9}, 
   3.780875605229167*^9, 3.78087577616148*^9, 3.7808759915602627`*^9, 
   3.780876096247147*^9, 3.7808761662529716`*^9, 3.780941578236026*^9, 
   3.780941609939746*^9, 3.7809509113601923`*^9, 3.780952178046096*^9, {
   3.780953456778162*^9, 3.780953472173744*^9}, 3.780967909669018*^9, 
   3.780968027358487*^9, 3.780968071993594*^9, 3.780968108090878*^9, {
   3.780968246940856*^9, 3.7809682674982567`*^9}, 3.7809683716992073`*^9, 
   3.780968456934762*^9, 3.780968602651018*^9, {3.7810430746127996`*^9, 
   3.781043084409852*^9}, 3.7810431439779797`*^9, 3.781043192134117*^9, 
   3.781043274253181*^9, 3.781043331668605*^9, 3.7810433965258913`*^9, 
   3.781043430915585*^9, 3.7810435162725277`*^9, {3.781043603665287*^9, 
   3.781043609640572*^9}, 3.781043753944059*^9, 3.781043822956812*^9, 
   3.7810439305881567`*^9, 3.7810444959098463`*^9, 3.78129274981558*^9, 
   3.7812928215552063`*^9},
 CellLabel->
  "Out[3293]=",ExpressionUUID->"8ba25516-587d-44bb-b238-fbf6e119711d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Calculate", " ", "JE", "*", 
     RowBox[{".", " ", "This"}], " ", "is", " ", "an", " ", "outer", " ", 
     "product", " ", "of", " ", "two", " ", "vectors"}], ",", " ", 
    RowBox[{
    "result", " ", "should", " ", "\[IndentingNewLine]", "be", " ", "a", " ", 
     "rank", " ", "2", " ", 
     RowBox[{"tensor", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"j1e1c", " ", "=", " ", 
    RowBox[{"Outer", "[", 
     RowBox[{"Times", ",", "j1", ",", 
      RowBox[{"Conjugate", "[", "e1", "]"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.780099724804241*^9, 3.780099784304246*^9}, {
   3.7800999452545652`*^9, 3.780099945942333*^9}, {3.780100236978488*^9, 
   3.780100291567219*^9}, {3.78016644984569*^9, 3.780166481888029*^9}, {
   3.7802617915254107`*^9, 3.78026179798696*^9}, {3.780968205769733*^9, 
   3.7809682082803793`*^9}, {3.7810431856306057`*^9, 3.781043186745915*^9}, 
   3.781044473869055*^9},
 CellLabel->
  "In[3294]:=",ExpressionUUID->"64979cd6-eb9c-4ff5-9895-8d36bf79b1cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Substitute", " ", "J"}], " ", "=", " ", 
    RowBox[{"nqu", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"j1e1c", "=", 
    RowBox[{"j1e1c", "/.", 
     RowBox[{
      RowBox[{"j1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
      RowBox[{"n", "*", "q", "*", 
       RowBox[{"u1", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}]}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.780099950516612*^9, 3.780099986963835*^9}, {
   3.7801000216887293`*^9, 3.78010002952637*^9}, {3.7801027660958157`*^9, 
   3.780102767523773*^9}, 3.7801652753573914`*^9, {3.78016649649648*^9, 
   3.780166517049951*^9}, {3.780362721442705*^9, 3.780362723304371*^9}, {
   3.780363149556149*^9, 3.78036315001439*^9}},
 CellLabel->
  "In[3295]:=",ExpressionUUID->"d72ba8ed-f085-4e2a-a4a1-a2849aae6a50"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"j1e1c", "=", 
    RowBox[{"j1e1c", "/.", 
     RowBox[{
      RowBox[{"j1", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
      RowBox[{"n", "*", "q", "*", 
       RowBox[{"u1", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"j1e1c", "=", 
   RowBox[{"j1e1c", "/.", 
    RowBox[{
     RowBox[{"j1", "[", 
      RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
     RowBox[{"n", "*", "q", "*", 
      RowBox[{"u1", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.780099935837647*^9, 3.780099940124297*^9}, {
  3.780100034045374*^9, 3.780100059557431*^9}, {3.780102771151305*^9, 
  3.780102775680726*^9}, {3.7801652766437187`*^9, 3.780165277590324*^9}, {
  3.780362725707272*^9, 3.780362729320443*^9}, {3.7803631526532373`*^9, 
  3.7803631559915247`*^9}},
 CellLabel->
  "In[3296]:=",ExpressionUUID->"2b8906ed-7b61-4955-957d-2049d6bcffac"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "dimensions", " ", "of", " ", "the", " ", 
    RowBox[{"term", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Dimensions", "[", "j1e1c", "]"}], "\[IndentingNewLine]", 
   RowBox[{"j1e1c", ";"}]}]}]], "Input",
 CellChangeTimes->{{3.780100148349557*^9, 3.780100201947056*^9}, {
   3.780100305981574*^9, 3.780100324143065*^9}, {3.780100476338121*^9, 
   3.7801005043254004`*^9}, {3.780101066894917*^9, 3.7801010689621687`*^9}, {
   3.78010112979031*^9, 3.780101149298479*^9}, {3.780101189029408*^9, 
   3.780101228336238*^9}, {3.780101379192442*^9, 3.780101381076408*^9}, {
   3.780101850100513*^9, 3.780101850905205*^9}, {3.780102135889024*^9, 
   3.780102138256906*^9}, {3.780102868757194*^9, 3.780102872499755*^9}, {
   3.780166519103224*^9, 3.780166546643035*^9}, {3.780950653984961*^9, 
   3.780950658532412*^9}, 3.781044470401496*^9},
 CellLabel->
  "In[3298]:=",ExpressionUUID->"f2e7b075-ad6f-4572-b205-806ac39c6bb9"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{
  3.780100324720862*^9, {3.7801004785825157`*^9, 3.7801005049053087`*^9}, 
   3.780101069936392*^9, {3.78010113074466*^9, 3.7801011508060713`*^9}, {
   3.780101199425487*^9, 3.7801012288253813`*^9}, 3.780101325677206*^9, 
   3.7801013815450974`*^9, 3.7801015196773233`*^9, {3.780101833503973*^9, 
   3.780101851423044*^9}, 3.780102139022717*^9, 3.780102778198701*^9, 
   3.780102872973695*^9, 3.7801038677866173`*^9, 3.78016756892213*^9, 
   3.780254108757612*^9, 3.780255514100595*^9, 3.7802559456653*^9, 
   3.78025604454403*^9, 3.780256122383234*^9, 3.780256497696329*^9, 
   3.7802566168278627`*^9, 3.780256681140493*^9, 3.7802603463618717`*^9, 
   3.780261809697101*^9, 3.780262367622821*^9, {3.780262891922164*^9, 
   3.7802629014603*^9}, 3.780263025777673*^9, 3.780267195899642*^9, 
   3.7803622247865458`*^9, 3.7803623904775677`*^9, {3.780362466607222*^9, 
   3.7803624948864822`*^9}, 3.780362542399914*^9, 3.7803630616031237`*^9, 
   3.780363140059127*^9, 3.780363206280814*^9, 3.780363466217988*^9, 
   3.780363547877626*^9, 3.780363651319681*^9, 3.780698461484462*^9, 
   3.7807008212878237`*^9, {3.780700896956231*^9, 3.780700936862566*^9}, {
   3.7808584414204073`*^9, 3.780858469789514*^9}, 3.7808598432426863`*^9, {
   3.780859914657249*^9, 3.780859921613405*^9}, 3.7808599676290216`*^9, {
   3.780860216514661*^9, 3.780860255502788*^9}, 3.780860299524398*^9, {
   3.780860363345484*^9, 3.780860383165948*^9}, 3.780860619438682*^9, 
   3.780860689607709*^9, 3.780861672727521*^9, 3.780868918792735*^9, {
   3.780869451353207*^9, 3.7808694774165087`*^9}, 3.780871696410613*^9, {
   3.780871740697118*^9, 3.780871815235886*^9}, 3.780873915577835*^9, 
   3.780874058686998*^9, 3.780874467117486*^9, 3.7808749207487173`*^9, 
   3.7808753727475643`*^9, {3.780875472339506*^9, 3.780875525772221*^9}, 
   3.780875605380466*^9, 3.7808757762873707`*^9, 3.780875991736143*^9, 
   3.7808760963828583`*^9, 3.780876166396947*^9, 3.780941578334155*^9, 
   3.780941610064815*^9, 3.7809506594520473`*^9, 3.7809509115242767`*^9, 
   3.780952186542992*^9, {3.780953456879883*^9, 3.780953472337317*^9}, 
   3.780967909869623*^9, 3.7809680274786367`*^9, 3.780968072179879*^9, 
   3.780968108182872*^9, {3.780968247127902*^9, 3.780968267632413*^9}, 
   3.78096837181149*^9, 3.780968457067895*^9, 3.7809686027930737`*^9, {
   3.7810430747955933`*^9, 3.781043084591566*^9}, 3.781043144134719*^9, 
   3.7810431923558683`*^9, 3.781043274447575*^9, 3.7810433318505993`*^9, 
   3.781043396702223*^9, 3.781043431067575*^9, 3.781043516452787*^9, {
   3.781043603907475*^9, 3.781043609812292*^9}, 3.781043754113337*^9, 
   3.781043823146696*^9, 3.781043930753038*^9, 3.781044496115835*^9, 
   3.7812927499294453`*^9, 3.7812928216322823`*^9},
 CellLabel->
  "Out[3298]=",ExpressionUUID->"24216c2e-941d-4449-a41c-a9af88f5c378"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Calculate", " ", "second", " ", "term", " ", "in", " ", "expression"}], 
    ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Del]", ".", 
       RowBox[{"(", 
        RowBox[{"JE", "*"}], " ", ")"}]}], ".", " ", "Result"}], " ", 
     "should", " ", "be", " ", "a", " ", 
     RowBox[{"vector", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ClearAll", "[", "term2", "]"}]}]], "Input",
 CellChangeTimes->{{3.7801027878267384`*^9, 3.780102800172469*^9}, {
  3.780166551965706*^9, 3.780166592534315*^9}},
 CellLabel->
  "In[3300]:=",ExpressionUUID->"e8e7c7ba-a5c0-4909-89f0-9bd6ecf59aa7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"term2", "=", 
    RowBox[{"Div", "[", 
     RowBox[{"j1e1c", ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7801028019012833`*^9, 3.7801028159738407`*^9}, {
   3.780103880334836*^9, 3.7801038974165*^9}, {3.780103947458284*^9, 
   3.7801039501505833`*^9}, {3.780166549813674*^9, 3.7801665507465677`*^9}, 
   3.780871683557561*^9, {3.7808717851519117`*^9, 3.780871785791499*^9}, 
   3.780873974906039*^9, {3.780874411637608*^9, 3.780874412489797*^9}, {
   3.780950832191162*^9, 3.780950834852499*^9}, {3.7809516276946077`*^9, 
   3.780951643124157*^9}, {3.780951917011424*^9, 3.780951918286179*^9}, {
   3.7809521105634003`*^9, 3.780952110957546*^9}, {3.780952190339143*^9, 
   3.78095220808821*^9}, {3.780953467436552*^9, 3.780953467865279*^9}, {
   3.780956805413872*^9, 3.780956820348184*^9}, {3.7809573442394257`*^9, 
   3.7809573445295753`*^9}, {3.780957401417602*^9, 3.7809574032529783`*^9}, {
   3.780958125515958*^9, 3.780958154164398*^9}, {3.7809583978990717`*^9, 
   3.780958400727687*^9}, {3.7809585559933023`*^9, 3.78095855870595*^9}, {
   3.780958591859314*^9, 3.780958594333118*^9}, {3.780968228409719*^9, 
   3.7809682314994793`*^9}, {3.781044466065812*^9, 3.7810444668537483`*^9}},
 CellLabel->
  "In[3301]:=",ExpressionUUID->"cfff2724-20ac-4e42-bad1-66be53cca707"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "to", " ", "confirm", " ", 
    RowBox[{"dimensions", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Dimensions", "[", "term2", "]"}]}]], "Input",
 CellChangeTimes->{{3.780102825549836*^9, 3.780102844183139*^9}, {
   3.7801653068701487`*^9, 3.780165307099639*^9}, {3.780166594955619*^9, 
   3.780166600663378*^9}, 3.780957565715137*^9, 3.7809672476116743`*^9},
 CellLabel->
  "In[3302]:=",ExpressionUUID->"8be182c7-0bfc-4a53-930a-d8bcf086818b"],

Cell[BoxData[
 RowBox[{"{", "3", "}"}]], "Output",
 CellChangeTimes->{{3.780102829721287*^9, 3.780102844661025*^9}, 
   3.7801028848704643`*^9, 3.7801039008914022`*^9, 3.780165307663598*^9, 
   3.780167576034706*^9, 3.7802541088264313`*^9, 3.7802555142085114`*^9, 
   3.780255945753474*^9, 3.780256044628915*^9, 3.780256122467907*^9, 
   3.780256497776504*^9, 3.780256616916436*^9, 3.780256681236977*^9, 
   3.780260346440668*^9, 3.780261819886571*^9, 3.78026236772764*^9, {
   3.7802628921102324`*^9, 3.780262901626802*^9}, 3.7802630259476423`*^9, 
   3.780267195973319*^9, 3.780362224872464*^9, 3.780362390562624*^9, {
   3.780362466769788*^9, 3.78036249496623*^9}, 3.7803625425439653`*^9, 
   3.780363061717679*^9, 3.780363140152121*^9, 3.780363206414558*^9, 
   3.780363466303914*^9, 3.7803635479767847`*^9, 3.78036365142393*^9, 
   3.7806984615675488`*^9, 3.780700821530137*^9, {3.780700897102253*^9, 
   3.7807009369990892`*^9}, {3.7808584414915648`*^9, 3.780858469868559*^9}, 
   3.780859843450942*^9, {3.780859914769417*^9, 3.780859921725986*^9}, 
   3.780859967703113*^9, {3.780860216649911*^9, 3.780860255607339*^9}, 
   3.780860299940652*^9, {3.780860363483307*^9, 3.780860383297222*^9}, 
   3.780860619577775*^9, 3.780860689736183*^9, 3.7808616728544292`*^9, 
   3.780868918919777*^9, {3.78086945146807*^9, 3.780869477542351*^9}, 
   3.780871696544588*^9, {3.780871740776874*^9, 3.78087181538477*^9}, 
   3.780873915662915*^9, 3.780874058794186*^9, 3.7808744673057404`*^9, 
   3.780874920833467*^9, 3.7808753728774*^9, {3.780875472479084*^9, 
   3.780875525899341*^9}, 3.78087560547368*^9, 3.7808757764104977`*^9, 
   3.780875991969521*^9, 3.7808760964617558`*^9, 3.7808761665068817`*^9, 
   3.780941578424602*^9, 3.780941610188155*^9, 3.780950853489223*^9, 
   3.7809509116594353`*^9, {3.780953456955142*^9, 3.780953472494878*^9}, 
   3.780957566101351*^9, 3.7809672483439083`*^9, 3.780967910004396*^9, 
   3.780968027598914*^9, 3.780968072285079*^9, 3.780968108267167*^9, {
   3.780968247292695*^9, 3.7809682677699957`*^9}, 3.7809683718913107`*^9, 
   3.7809684571562147`*^9, 3.780968602925519*^9, {3.781043074979678*^9, 
   3.781043084778337*^9}, 3.781043144234373*^9, 3.781043192703928*^9, 
   3.78104327457712*^9, 3.781043332060556*^9, 3.7810433969458437`*^9, 
   3.781043431245304*^9, 3.781043516621441*^9, {3.781043604011753*^9, 
   3.781043610005109*^9}, 3.78104375428756*^9, 3.7810438234585943`*^9, 
   3.781043931027452*^9, 3.7810444964274597`*^9, 3.7812927500732203`*^9, 
   3.7812928217512703`*^9},
 CellLabel->
  "Out[3302]=",ExpressionUUID->"31618797-fbf1-43fe-95b5-65dfdb325409"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Calculate", " ", "uu", "*", 
     RowBox[{".", " ", "Another"}], " ", "outer", " ", "product", " ", "of", 
     " ", "2", " ", "vectors"}], ",", " ", 
    RowBox[{"result", " ", "is", " ", "rank", " ", "2", " ", 
     RowBox[{"tensor", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"u1u1c", "=", 
    RowBox[{"Outer", "[", 
     RowBox[{"Times", ",", "u1", ",", 
      RowBox[{"Conjugate", "[", "u1", "]"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.780102946318721*^9, 3.780102977734284*^9}, {
   3.7801030096549673`*^9, 3.780103025948462*^9}, {3.780103104664029*^9, 
   3.7801031112374773`*^9}, {3.7801666049496517`*^9, 3.780166636019198*^9}, {
   3.7802561153535843`*^9, 3.780256116207272*^9}, {3.780256585936796*^9, 
   3.780256611767254*^9}, {3.780256642363121*^9, 3.780256643431385*^9}, {
   3.780260288865129*^9, 3.780260289246868*^9}, {3.780261824591711*^9, 
   3.7802618283222313`*^9}, {3.7809682364360228`*^9, 3.780968239255772*^9}, {
   3.7810431766462708`*^9, 3.781043178536508*^9}, 3.7810444623414927`*^9},
 CellLabel->
  "In[3303]:=",ExpressionUUID->"84a177a2-49c8-4bd8-aa5e-425c4ae83071"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "result", " ", "dimensions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Dimensions", "[", "u1u1c", "]"}]}]], "Input",
 CellChangeTimes->{{3.780102980585002*^9, 3.780102985088058*^9}, {
  3.7801030283161993`*^9, 3.780103031185152*^9}, {3.780166638127534*^9, 
  3.780166643151822*^9}},
 CellLabel->
  "In[3304]:=",ExpressionUUID->"8db26c2f-7136-4e48-b582-5461923f79e1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"3", ",", "3"}], "}"}]], "Output",
 CellChangeTimes->{
  3.780102985431938*^9, {3.780103030037464*^9, 3.7801030326085987`*^9}, 
   3.780103114239491*^9, 3.7801039080524397`*^9, 3.780165313573186*^9, 
   3.7801675790477057`*^9, 3.7802541088893423`*^9, 3.780255514298893*^9, 
   3.7802559458326283`*^9, 3.780256044695244*^9, 3.780256122543171*^9, 
   3.780256497846641*^9, 3.780256616993492*^9, 3.780256681313932*^9, 
   3.78026034650555*^9, 3.7802618336785517`*^9, 3.7802623677840567`*^9, {
   3.780262892198493*^9, 3.780262901729436*^9}, 3.78026302603817*^9, 
   3.78026719603275*^9, 3.7803622249432096`*^9, 3.78036239063866*^9, {
   3.7803624668429937`*^9, 3.780362495033311*^9}, 3.780362542616284*^9, 
   3.780363061780551*^9, 3.7803631402272987`*^9, 3.780363206491867*^9, 
   3.780363466376392*^9, 3.780363548028963*^9, 3.780363651481442*^9, 
   3.780698461636845*^9, 3.780700821737872*^9, {3.7807008971778708`*^9, 
   3.780700937070714*^9}, {3.780858441549128*^9, 3.7808584699321613`*^9}, 
   3.7808598435638742`*^9, {3.78085991483272*^9, 3.780859921788916*^9}, 
   3.780859967763981*^9, {3.7808602167238607`*^9, 3.78086025566492*^9}, 
   3.78086030012005*^9, {3.7808603635604258`*^9, 3.780860383381248*^9}, 
   3.780860619650893*^9, 3.780860689811948*^9, 3.78086167292673*^9, 
   3.780868918990983*^9, {3.780869451532909*^9, 3.780869477614249*^9}, 
   3.7808716966251183`*^9, {3.7808717408479843`*^9, 3.780871815494422*^9}, 
   3.780873915738241*^9, 3.780874058857111*^9, 3.780874467407089*^9, 
   3.780874920907886*^9, 3.780875372956523*^9, {3.7808754725539227`*^9, 
   3.780875525969057*^9}, 3.7808756055496683`*^9, 3.7808757764780684`*^9, 
   3.7808759921073217`*^9, 3.780876096530054*^9, 3.7808761665871964`*^9, 
   3.780941578476143*^9, 3.780941610251007*^9, 3.78095091173728*^9, {
   3.780953457006571*^9, 3.780953472574821*^9}, 3.780967910102776*^9, 
   3.780968027662448*^9, 3.7809680723785887`*^9, 3.780968108351059*^9, {
   3.780968247391573*^9, 3.780968267849779*^9}, 3.7809683719465437`*^9, 
   3.7809684572216063`*^9, 3.780968603003483*^9, {3.781043075077321*^9, 
   3.781043084883457*^9}, 3.781043144311058*^9, 3.7810431928283253`*^9, 
   3.7810432746785517`*^9, 3.781043332259479*^9, 3.781043397175284*^9, 
   3.781043431327582*^9, 3.7810435167349377`*^9, {3.781043604107708*^9, 
   3.781043610121756*^9}, 3.7810437543745213`*^9, 3.781043823560297*^9, 
   3.781043931114718*^9, 3.7810444965202227`*^9, 3.781292750147889*^9, 
   3.781292821805004*^9},
 CellLabel->
  "Out[3304]=",ExpressionUUID->"b0fd6506-8ca7-4de4-ad04-4ae44c715edc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Calculate", " ", "third", " ", "term", " ", "in", " ", "expression"}], 
    ",", " ", 
    RowBox[{
     RowBox[{"\[Del]", ".", 
      RowBox[{"(", 
       RowBox[{"nmuu", "*"}], " ", ")"}]}], "."}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ClearAll", "[", "term3", "]"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"term3a", "=", 
     RowBox[{"Div", "[", 
      RowBox[{"u1u1c", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.780103037599462*^9, 3.7801030654143476`*^9}, {
   3.780103916069962*^9, 3.780103918300352*^9}, {3.7801039915010567`*^9, 
   3.780104014594777*^9}, {3.780166645812997*^9, 3.780166664157238*^9}, {
   3.7802555065661087`*^9, 3.7802555076506853`*^9}, {3.780256118635152*^9, 
   3.7802561190462027`*^9}, 3.7808716877729797`*^9, {3.78087176625846*^9, 
   3.78087176688811*^9}, 3.780873978885048*^9, {3.78087441691929*^9, 
   3.7808744173946953`*^9}, {3.780950263901518*^9, 3.7809502790174837`*^9}, {
   3.7809503653822813`*^9, 3.780950413239545*^9}, {3.780950866642179*^9, 
   3.78095090660457*^9}, {3.780951683994567*^9, 3.780951685531086*^9}, 
   3.7809672627199163`*^9, 3.7810444605999537`*^9},
 CellLabel->
  "In[3305]:=",ExpressionUUID->"cdb0caa4-ac28-45ad-a62d-5df22205ad87"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"term3", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Total", "[", 
      RowBox[{"term3a", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "2"}], ",", 
         RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], "]"}], ",", "0", ",", 
     "0"}], "}"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.780967282501878*^9, 3.7809672956131687`*^9}, {
  3.7809678986468687`*^9, 3.780967902584318*^9}, {3.780968057156384*^9, 
  3.7809680986278687`*^9}},
 CellLabel->
  "In[3307]:=",ExpressionUUID->"36843598-1922-423d-a721-290937657c9e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Check", " ", "dimensions", " ", "of", " ", 
    RowBox[{"result", ".", " ", "Should"}], " ", "be", " ", "a", " ", 
    RowBox[{"vector", "."}]}], " ", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{"Dimensions", "[", "term3a", "]"}]}]], "Input",
 CellChangeTimes->{{3.780103074955131*^9, 3.7801030880290823`*^9}, {
   3.780166669937027*^9, 3.780166682198636*^9}, {3.78026184680828*^9, 
   3.780261849441392*^9}, {3.780968060823476*^9, 3.780968064830812*^9}, 
   3.780968101969077*^9},
 CellLabel->
  "In[3308]:=",ExpressionUUID->"b816106d-a944-4f8c-8ebc-0433385defbc"],

Cell[BoxData[
 RowBox[{"{", "3", "}"}]], "Output",
 CellChangeTimes->{{3.780103081042025*^9, 3.7801030884733753`*^9}, 
   3.780103119133286*^9, 3.780103920881032*^9, 3.780104000847205*^9, 
   3.7801653174721107`*^9, 3.780167582295994*^9, 3.780254108950145*^9, 
   3.780255514390201*^9, 3.780255945906287*^9, 3.780256044776623*^9, 
   3.780256122616712*^9, 3.780256497915153*^9, 3.780256617068171*^9, 
   3.780256681405931*^9, 3.780260346580798*^9, 3.780261850165189*^9, 
   3.780262367843206*^9, {3.780262892285001*^9, 3.780262901830834*^9}, 
   3.780263026121262*^9, 3.780267196095231*^9, 3.78036222502033*^9, 
   3.780362390791396*^9, {3.780362466929823*^9, 3.780362495100721*^9}, 
   3.780362542690146*^9, 3.7803630618507767`*^9, 3.780363140303162*^9, 
   3.7803632065698957`*^9, 3.780363466448864*^9, 3.780363548106812*^9, 
   3.780363651540428*^9, 3.780698461704528*^9, 3.780700821845291*^9, {
   3.7807008972541933`*^9, 3.780700937145452*^9}, {3.780858441607613*^9, 
   3.780858470009803*^9}, 3.780859843688839*^9, {3.780859914899671*^9, 
   3.780859921858971*^9}, 3.78085996783125*^9, {3.7808602167994432`*^9, 
   3.7808602557234783`*^9}, 3.78086030023971*^9, {3.78086036363733*^9, 
   3.780860383454235*^9}, 3.780860619730794*^9, 3.780860689892597*^9, 
   3.780861672997796*^9, 3.780868919058567*^9, {3.7808694515994883`*^9, 
   3.780869477687976*^9}, 3.7808716967087584`*^9, {3.780871740919475*^9, 
   3.78087181558575*^9}, 3.78087391581833*^9, 3.780874058921826*^9, 
   3.780874467528368*^9, 3.7808749209751387`*^9, 3.780875373039843*^9, {
   3.7808754726629057`*^9, 3.780875526039001*^9}, 3.780875605632745*^9, 
   3.780875776543537*^9, 3.7808759923693323`*^9, 3.780876096599818*^9, 
   3.780876166655199*^9, 3.780941578530261*^9, 3.780941610315113*^9, 
   3.7809509118089333`*^9, {3.780953457062213*^9, 3.780953472659395*^9}, {
   3.780967906406014*^9, 3.780967910282617*^9}, 3.7809680277760887`*^9, 
   3.780968072511128*^9, 3.780968108503105*^9, {3.780968247563195*^9, 
   3.780968267989437*^9}, 3.780968372055402*^9, 3.780968457346635*^9, 
   3.780968603128129*^9, {3.781043075382032*^9, 3.781043085097643*^9}, 
   3.7810431444387007`*^9, 3.781043192974532*^9, 3.7810432748605213`*^9, 
   3.7810433324681273`*^9, 3.781043397385069*^9, 3.781043431482946*^9, 
   3.781043516983727*^9, {3.781043604304878*^9, 3.781043610345635*^9}, 
   3.781043754538313*^9, 3.781043823784664*^9, 3.7810439312571583`*^9, 
   3.78104449671732*^9, 3.781292750265623*^9, 3.781292821868924*^9},
 CellLabel->
  "Out[3308]=",ExpressionUUID->"b7bef631-d1d3-4792-af44-d6ef37f8222b"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Calculate", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"i", "/", "om"}], ")"}], "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Del]", "E"}], "*"}], " ", ")"}], "J"}], " ", "-", " ", 
       RowBox[{"\[Del]", ".", 
        RowBox[{"(", 
         RowBox[{"JE", "*"}], " ", ")"}]}]}], "]"}]}], " ", "-", " ", 
    RowBox[{"\[Del]", ".", 
     RowBox[{"(", 
      RowBox[{"nmuu", "*"}], " ", ")"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"pf", "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"I", "/", "om"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"term1", "-", "term2"}], ")"}]}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{"term3a", "*", "m", "*", "n"}], ")"}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.780103226557416*^9, 3.78010325679281*^9}, 
   3.780103545295396*^9, {3.78016668664847*^9, 3.780166741455078*^9}, {
   3.780256493874794*^9, 3.780256494037592*^9}, {3.7802603048266687`*^9, 
   3.780260309514002*^9}, 3.780261854263295*^9, {3.780262872435052*^9, 
   3.780262896069523*^9}, {3.7808606837979527`*^9, 3.7808606852855864`*^9}, 
   3.7808713375447493`*^9, 3.7808756458622227`*^9, 3.780968104544622*^9},
 CellLabel->
  "In[3309]:=",ExpressionUUID->"b53729de-012a-425e-97a1-1d30b28c7298"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Check", " ", "dimensions", " ", "again", " ", "to", " ", "ensure", " ", 
    "they", " ", "were", " ", 
    RowBox[{"maintained", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Dimensions", "[", "pf", "]"}]}]], "Input",
 CellChangeTimes->{{3.780103258821628*^9, 3.780103261935453*^9}, {
  3.780103296535974*^9, 3.780103301456066*^9}, {3.780103519186187*^9, 
  3.780103538555019*^9}, {3.780166699187481*^9, 3.780166700999056*^9}, {
  3.780166757955081*^9, 3.780166777922799*^9}},
 CellLabel->
  "In[3310]:=",ExpressionUUID->"d9bb899d-d67b-4bdb-a69d-9b846fd81806"],

Cell[BoxData[
 RowBox[{"{", "3", "}"}]], "Output",
 CellChangeTimes->{{3.780103262354623*^9, 3.780103301964814*^9}, {
   3.780103521930154*^9, 3.780103552293384*^9}, 3.7801039252969837`*^9, 
   3.7801040971656313`*^9, 3.780165323825889*^9, 3.780166702388626*^9, 
   3.780167115894884*^9, 3.780167591694655*^9, 3.780254109012116*^9, 
   3.7802555144831038`*^9, 3.7802559459873343`*^9, 3.7802560448571157`*^9, 
   3.780256122699133*^9, 3.7802564979979343`*^9, 3.780256617154026*^9, 
   3.780256681633806*^9, 3.780260346665092*^9, 3.780261856873095*^9, 
   3.7802623678972893`*^9, {3.780262892377017*^9, 3.780262901931781*^9}, 
   3.780263026197015*^9, 3.780267196148411*^9, 3.780362225088541*^9, 
   3.780362390863119*^9, {3.780362467005727*^9, 3.78036249515942*^9}, 
   3.780362542761456*^9, 3.780363061904429*^9, 3.7803631403679533`*^9, 
   3.78036320664312*^9, 3.780363466539053*^9, 3.780363548160713*^9, 
   3.780363651591947*^9, 3.78069846176195*^9, 3.7807008219385977`*^9, {
   3.7807008973292522`*^9, 3.780700937216613*^9}, {3.780858441661847*^9, 
   3.780858470066448*^9}, 3.780859843800839*^9, {3.78085991496667*^9, 
   3.780859921922125*^9}, 3.780859967890428*^9, {3.780860216871572*^9, 
   3.780860255782278*^9}, 3.780860300448133*^9, {3.7808603639087973`*^9, 
   3.780860383532683*^9}, 3.780860619805369*^9, 3.7808606899720707`*^9, 
   3.780861673067168*^9, {3.780869451660923*^9, 3.7808694777623663`*^9}, 
   3.7808716967810373`*^9, {3.7808717409929333`*^9, 3.780871815654891*^9}, 
   3.7808739158950043`*^9, 3.780874058987178*^9, 3.780874467625656*^9, 
   3.780874921078238*^9, 3.780875373148538*^9, {3.780875472751885*^9, 
   3.780875526109062*^9}, 3.780875605872691*^9, 3.780875776604519*^9, 
   3.7808759924596167`*^9, 3.780876096668417*^9, 3.780876166775107*^9, 
   3.780941578576129*^9, 3.780941610379999*^9, 3.7809509118800497`*^9, {
   3.780953457116292*^9, 3.7809534727452374`*^9}, 3.7809679104530697`*^9, 
   3.780968027837228*^9, 3.780968072583529*^9, 3.780968108588071*^9, {
   3.7809682476932373`*^9, 3.780968268056939*^9}, 3.780968372113084*^9, 
   3.780968457410185*^9, 3.7809686031970243`*^9, {3.781043075483321*^9, 
   3.7810430852116613`*^9}, 3.781043144512088*^9, 3.7810431930934134`*^9, 
   3.781043275017356*^9, 3.781043332575495*^9, 3.781043397481765*^9, 
   3.781043431558486*^9, 3.781043517079426*^9, {3.781043604393446*^9, 
   3.781043610445298*^9}, 3.781043754645301*^9, 3.7810438238778143`*^9, 
   3.7810439313582907`*^9, 3.781044496823238*^9, 3.7812927503452873`*^9, 
   3.781292821922449*^9},
 CellLabel->
  "Out[3310]=",ExpressionUUID->"f892ad3d-af55-450e-9ca7-f394aa473ee1"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Complete", " ", "substitutions", " ", "for", " ", 
      RowBox[{"u", ":", " ", "\[IndentingNewLine]", "ux"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "*", "om", "*", "Ex"}], " ", "-", " ", 
          RowBox[{"OMz", "*", "Ey"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], " ", "-", " ", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", "   ", 
    RowBox[{"uy", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"i", "*", "om", "*", "Ey"}], " ", "+", " ", 
          RowBox[{"OMz", "*", "Ex"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], " ", "-", " ", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", "   ", 
    RowBox[{"uz", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"i", "/", "om"}], ")"}], "*", 
      RowBox[{"Ez", "."}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"pf", "=", 
    RowBox[{"pf", "/.", 
     RowBox[{
      RowBox[{"u1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"q", "/", "m"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"I", "*", "om", "*", 
            RowBox[{"e1", "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], " ", "-", " ", 
           RowBox[{"OMz", "*", 
            RowBox[{"e1", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "/", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"om", "^", "2"}], " ", "-", " ", 
           RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}]}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.780163921594118*^9, 3.7801640634009666`*^9}, {
   3.780164156471271*^9, 3.780164157189085*^9}, 3.780165332679652*^9, {
   3.780166798576289*^9, 3.780166957241786*^9}, {3.780362748205394*^9, 
   3.780362765639855*^9}, {3.7808687121447144`*^9, 3.780868729038731*^9}, {
   3.780869438053944*^9, 3.780869446302602*^9}, {3.780872901319415*^9, 
   3.7808729862864113`*^9}, 3.780875340420927*^9, 3.780875486162375*^9, {
   3.78094147838663*^9, 3.780941485211175*^9}, {3.780953400128661*^9, 
   3.7809534003633823`*^9}},
 CellLabel->
  "In[3311]:=",ExpressionUUID->"ace7229e-0e69-4b00-b02c-6fa717a82c90"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"u1", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", " ", 
         RowBox[{
          RowBox[{"I", "*", "om", "*", 
           RowBox[{"e1", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], " ", "+", " ", 
          RowBox[{"OMz", "*", 
           RowBox[{"e1", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], " ", "-", " ", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.780164090825012*^9, 3.780164104470294*^9}, {
   3.780164160533584*^9, 3.78016416294886*^9}, 3.7801653358591623`*^9, {
   3.780166799672727*^9, 3.780166799953906*^9}, {3.780362751272443*^9, 
   3.780362772734973*^9}, {3.780868717721575*^9, 3.78086873093324*^9}, {
   3.7808694394347467`*^9, 3.78086944806507*^9}, {3.780872993747904*^9, 
   3.780873010764283*^9}, {3.780873983283771*^9, 3.780873989216552*^9}, {
   3.780874422596921*^9, 3.780874425835417*^9}, 3.780875339725861*^9, 
   3.780875483837882*^9, {3.7809414989083977`*^9, 3.780941503026247*^9}, {
   3.780953400531636*^9, 3.7809534006819363`*^9}},
 CellLabel->
  "In[3312]:=",ExpressionUUID->"5e607b55-1c22-483c-9caa-0f1177206757"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"pf", "=", 
    RowBox[{"pf", "/.", 
     RowBox[{
      RowBox[{"u1", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"I", "/", "om"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"q", "/", "m"}], ")"}], "*", 
       RowBox[{"e1", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Complete", " ", "substitutions", " ", "for", " ", "u", "*"}], 
      ":", " ", "\[IndentingNewLine]", 
      RowBox[{"ux", "*"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "*", "om", "*", "Ex", "*", " ", 
          RowBox[{"-", " ", "OMz"}], "*", "Ey", "*"}], " ", ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], " ", "-", " ", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", "   ", 
    RowBox[{
     RowBox[{"uy", "*"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"i", "*", "om", "*", "Ey", "*", " ", 
          RowBox[{"+", " ", "OMz"}], "*", "Ex", "*"}], " ", ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], " ", "-", " ", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}], ",", 
    "\[IndentingNewLine]", "   ", 
    RowBox[{
     RowBox[{"uz", "*"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"i", "/", "om"}], ")"}], "*", "Ez", "*", "."}]}]}], 
   "\[IndentingNewLine]", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7801641149526787`*^9, 3.780164168188017*^9}, 
   3.780165338523718*^9, {3.780166800185038*^9, 3.780166800551374*^9}, {
   3.780166980216*^9, 3.7801670008976183`*^9}, {3.780262990217456*^9, 
   3.7802629921499023`*^9}, {3.7803627578011293`*^9, 3.780362776704782*^9}, {
   3.780873985420085*^9, 3.780873999406106*^9}, {3.780874423892652*^9, 
   3.780874427094043*^9}, 3.7808753386540728`*^9, 3.7808754819410057`*^9, 
   3.7808756476135178`*^9, {3.7809415036229677`*^9, 3.780941504010798*^9}, {
   3.780953400823146*^9, 3.780953400976789*^9}, 3.780968259320446*^9, {
   3.7809683130320683`*^9, 3.780968318188525*^9}, {3.78096843188675*^9, 
   3.780968433486125*^9}, {3.7810432983949327`*^9, 3.781043304767128*^9}, {
   3.781044434655837*^9, 3.781044449357099*^9}},
 CellLabel->
  "In[3313]:=",ExpressionUUID->"8c4516e2-e09b-408f-a8b0-453848a81627"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"Conjugate", "[", 
      RowBox[{"u1", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", "*", "om", "*", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"e1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], " ", "-", " ", 
          RowBox[{"OMz", "*", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"e1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], " ", "-", " ", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.780164174452942*^9, 3.7801642097021*^9}, 
   3.78016534107331*^9, {3.780166800717142*^9, 3.7801668008947906`*^9}, {
   3.780261902265561*^9, 3.78026193264625*^9}, {3.780362783668336*^9, 
   3.7803627966627417`*^9}, {3.7808687462715807`*^9, 3.780868751848909*^9}, {
   3.780869425413802*^9, 3.780869434730064*^9}, {3.7808731314657803`*^9, 
   3.780873151820785*^9}, 3.780875767567617*^9, 3.780875854472003*^9, {
   3.7809415046738577`*^9, 3.7809415243982153`*^9}, {3.780941583575292*^9, 
   3.780941583669031*^9}, {3.780953401119157*^9, 3.780953401266961*^9}, {
   3.7809679900783052`*^9, 3.78096799194633*^9}},
 CellLabel->
  "In[3314]:=",ExpressionUUID->"c4cdf3a4-bab6-4f9f-8730-65d2aa9499a5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"Conjugate", "[", 
      RowBox[{"u1", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", "*", "om", "*", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"e1", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "]"}]}], " ", "+", " ", 
          RowBox[{"OMz", "*", 
           RowBox[{"Conjugate", "[", 
            RowBox[{"e1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], " ", "-", " ", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.78016422437624*^9, 3.780164229426318*^9}, 
   3.780165342812989*^9, {3.780166801098282*^9, 3.780166801263291*^9}, {
   3.780261935903307*^9, 3.780261955658565*^9}, {3.780362802760881*^9, 
   3.780362807302404*^9}, {3.780860608840082*^9, 3.780860610950392*^9}, {
   3.780868754336266*^9, 3.780868759907577*^9}, {3.7808694243305483`*^9, 
   3.780869435967992*^9}, {3.780873230742605*^9, 3.780873266557621*^9}, {
   3.780874003494176*^9, 3.780874003634425*^9}, {3.7808744326833773`*^9, 
   3.780874432783031*^9}, {3.780941505177279*^9, 3.780941528000215*^9}, {
   3.7809415853802433`*^9, 3.780941585466107*^9}, {3.7809534014338627`*^9, 
   3.780953401583186*^9}, {3.780967993390292*^9, 3.78096799518122*^9}},
 CellLabel->
  "In[3315]:=",ExpressionUUID->"1f0a54b3-e0c3-4d33-a6c3-f00245cf6f99"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"Conjugate", "[", 
      RowBox[{"u1", "[", 
       RowBox[{"[", "3", "]"}], "]"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"I", "/", "om"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"Conjugate", "[", 
       RowBox[{"e1", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.780164235460059*^9, 3.780164247369194*^9}, 
   3.780165344659567*^9, {3.780166801431218*^9, 3.780166801612631*^9}, {
   3.780261959008316*^9, 3.780261969984695*^9}, {3.780263001580476*^9, 
   3.7802630029703007`*^9}, {3.78036281168163*^9, 3.780362815377513*^9}, {
   3.780874011427182*^9, 3.780874011599248*^9}, {3.780874433969338*^9, 
   3.780874434082357*^9}, {3.780941505958243*^9, 3.780941533983657*^9}, {
   3.7809534017487288`*^9, 3.780953401887669*^9}, {3.780967996523181*^9, 
   3.7809679966519957`*^9}, {3.780968296245096*^9, 3.780968305751336*^9}, {
   3.780968438191486*^9, 3.780968439224863*^9}},
 CellLabel->
  "In[3316]:=",ExpressionUUID->"93525c6a-92e0-4da6-9c52-0f211d92b860"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Simplify", "[", "pf", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Complete", " ", "substitutions", " ", "for", " ", 
    RowBox[{"D", "[", 
     RowBox[{"u", ",", 
      RowBox[{"[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "]"}], " ", "and", " ", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"u", "*"}], ",", 
      RowBox[{"[", 
       RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], "]"}]}], " ", 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.780164256490919*^9, 3.780164259159781*^9}, 
   3.7801653473679533`*^9, 3.7801668017847757`*^9, {3.780167011335355*^9, 
   3.780167048143381*^9}, 3.780941506318046*^9, 3.78094168567188*^9, 
   3.780953402040373*^9, 3.780968257247589*^9, {3.7810444141893387`*^9, 
   3.781044416678091*^9}, 3.78104451345184*^9},
 CellLabel->
  "In[3317]:=",ExpressionUUID->"943029c4-5f0f-4069-9747-f8328c725320"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "z"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", "*", "om", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"e1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "z"}], "]"}]}], " ", "-", 
          " ", 
          RowBox[{"OMz", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"e1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "z"}], "]"}]}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], "-", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.780164567886908*^9, 3.780164699445024*^9}, {
   3.780164767905064*^9, 3.780164768790859*^9}, 3.780165352405343*^9, {
   3.7801668019326363`*^9, 3.7801668020765667`*^9}, {3.780362821191985*^9, 
   3.7803628304341297`*^9}, {3.780868783549143*^9, 3.7808687886384487`*^9}, {
   3.780869417081152*^9, 3.780869422082868*^9}, {3.78087333552285*^9, 
   3.780873379311499*^9}, {3.780941506461804*^9, 3.780941506627653*^9}, {
   3.7809415497234364`*^9, 3.780941551228835*^9}, {3.7809534021580667`*^9, 
   3.780953402302148*^9}},
 CellLabel->
  "In[3318]:=",ExpressionUUID->"4dece9a2-067d-4d29-9771-7f67308b6324"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Conjugate", "[", 
        RowBox[{"u1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "z"}], "]"}], "\[Rule]", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", "*", "om", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", 
              RowBox[{"e1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "z"}], "]"}]}], 
          " ", "-", " ", 
          RowBox[{"OMz", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", 
              RowBox[{"e1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "z"}], "]"}]}]}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], "-", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.780164711999934*^9, 3.780164718831456*^9}, {
   3.780164773466618*^9, 3.7801647743770437`*^9}, 3.780165354291737*^9, {
   3.780166802252194*^9, 3.780166802416724*^9}, {3.78026198262243*^9, 
   3.7802620027405*^9}, {3.780362834591868*^9, 3.780362846604374*^9}, {
   3.780868793377407*^9, 3.7808687992303534`*^9}, {3.780869410347123*^9, 
   3.780869415789772*^9}, {3.7808733912730427`*^9, 3.7808734458692913`*^9}, {
   3.780874020065174*^9, 3.780874020216518*^9}, {3.7808744368662977`*^9, 
   3.780874436965364*^9}, {3.7809415068020687`*^9, 3.780941506979898*^9}, {
   3.7809415394253263`*^9, 3.780941539474348*^9}, {3.780941589422996*^9, 
   3.780941589496003*^9}, {3.780953402451564*^9, 3.780953402582006*^9}, {
   3.7809680015836897`*^9, 3.780968003344412*^9}},
 CellLabel->
  "In[3319]:=",ExpressionUUID->"f93aa26e-8936-451d-8c4a-a8a5c1aa51b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "x"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", "*", "om", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"e1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "x"}], "]"}]}], " ", "-", 
          " ", 
          RowBox[{"OMz", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"e1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "x"}], "]"}]}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], "-", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.780164727081708*^9, 3.780164732311697*^9}, {
   3.7801647776815853`*^9, 3.780164778624057*^9}, 3.780165356546731*^9, {
   3.780166802581285*^9, 3.7801668027570887`*^9}, {3.780362855972282*^9, 
   3.780362864886656*^9}, {3.7808688021086187`*^9, 3.780868813484435*^9}, {
   3.7808694022956467`*^9, 3.780869407235862*^9}, {3.780873486907151*^9, 
   3.7808734931020117`*^9}, {3.780941507143549*^9, 3.7809415073135138`*^9}, {
   3.7809534027186623`*^9, 3.780953402865909*^9}},
 CellLabel->
  "In[3320]:=",ExpressionUUID->"7c94deda-3865-4ef5-a356-f1dd5bc7e76a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", "y"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", "*", "om", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"e1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "y"}], "]"}]}], " ", "-", 
          " ", 
          RowBox[{"OMz", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"e1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "y"}], "]"}]}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], "-", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.7801647403869467`*^9, 3.780164744121364*^9}, {
   3.780164783328589*^9, 3.7801647842696657`*^9}, 3.7801653593358583`*^9, {
   3.7801668029082413`*^9, 3.780166803072854*^9}, {3.780362868386643*^9, 
   3.780362877568143*^9}, {3.7808688035958776`*^9, 3.780868814992799*^9}, {
   3.7808693957808523`*^9, 3.7808694010856667`*^9}, {3.780873500440897*^9, 
   3.780873504923451*^9}, {3.780874023577013*^9, 3.780874023748207*^9}, {
   3.780874438386717*^9, 3.780874438517783*^9}, {3.7809415074775467`*^9, 
   3.78094150766304*^9}, {3.7809534030035954`*^9, 3.78095340314305*^9}},
 CellLabel->
  "In[3321]:=",ExpressionUUID->"7832ce6a-86e3-41eb-ade7-a0f17df334e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Conjugate", "[", 
        RowBox[{"u1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "y"}], "]"}], "\[Rule]", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", "*", "om", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", 
              RowBox[{"e1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "y"}], "]"}]}], 
          " ", "-", " ", 
          RowBox[{"OMz", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", 
              RowBox[{"e1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "y"}], "]"}]}]}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], "-", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.780164788405344*^9, 3.780164804177642*^9}, 
   3.7801653616311607`*^9, {3.780166803233832*^9, 3.780166803373083*^9}, {
   3.780262032427088*^9, 3.780262048824272*^9}, {3.7803628812844753`*^9, 
   3.780362890740329*^9}, {3.780868818519651*^9, 3.78086882500704*^9}, {
   3.780869387594706*^9, 3.780869393940696*^9}, {3.780873516961235*^9, 
   3.780873524146245*^9}, {3.780874026843631*^9, 3.7808740270152683`*^9}, {
   3.780874439745223*^9, 3.780874439958395*^9}, {3.780941507834158*^9, 
   3.780941508011858*^9}, {3.78094155470268*^9, 3.780941554782353*^9}, {
   3.780941593468376*^9, 3.7809415935534487`*^9}, {3.780953403289221*^9, 
   3.7809534034487457`*^9}, {3.780968005072165*^9, 3.780968006583763*^9}},
 CellLabel->
  "In[3322]:=",ExpressionUUID->"1e3d5d02-3c1b-4b6b-8e36-4477734f6777"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Conjugate", "[", 
        RowBox[{"u1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "x"}], "]"}], "\[Rule]", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", "*", "om", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", 
              RowBox[{"e1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "x"}], "]"}]}], 
          " ", "-", " ", 
          RowBox[{"OMz", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", 
              RowBox[{"e1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "x"}], "]"}]}]}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], "-", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.7801648161002197`*^9, 3.780164819966004*^9}, 
   3.7801653633481703`*^9, {3.780166803535948*^9, 3.780166803674115*^9}, {
   3.7802620547912817`*^9, 3.7802620742173634`*^9}, {3.7803628985239697`*^9, 
   3.780362906014015*^9}, {3.780868827581999*^9, 3.780868836719398*^9}, {
   3.780869378868746*^9, 3.780869386049959*^9}, {3.7808735286811934`*^9, 
   3.78087353247511*^9}, {3.780875833755287*^9, 3.780875846653191*^9}, {
   3.780941508185706*^9, 3.780941508345479*^9}, {3.780941556446115*^9, 
   3.780941556550314*^9}, {3.78094159479986*^9, 3.780941594853424*^9}, {
   3.780953403599613*^9, 3.7809534037356787`*^9}, {3.78096800746738*^9, 
   3.780968008710494*^9}},
 CellLabel->
  "In[3323]:=",ExpressionUUID->"944c28c3-0ad5-45cf-b124-bf72553c6023"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "x"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", "*", "om", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"e1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "x"}], "]"}]}], " ", "+", 
          " ", 
          RowBox[{"OMz", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"e1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "x"}], "]"}]}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], " ", "-", " ", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.780164862856246*^9, 3.780164877638606*^9}, 
   3.7801653668670607`*^9, {3.780166803823217*^9, 3.780166803961382*^9}, {
   3.780362911394973*^9, 3.780362918577924*^9}, {3.780868844829266*^9, 
   3.780868859450308*^9}, {3.78086934422204*^9, 3.780869354924452*^9}, {
   3.780873556837632*^9, 3.7808736011485853`*^9}, {3.780874041897565*^9, 
   3.780874042073732*^9}, {3.7808744425422583`*^9, 3.780874442696444*^9}, {
   3.7809415085105247`*^9, 3.780941508679082*^9}, {3.780953403901066*^9, 
   3.7809534040666428`*^9}},
 CellLabel->
  "In[3324]:=",ExpressionUUID->"c57a25c4-53b9-4999-8fc8-7496b1347e88"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "y"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", "*", "om", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"e1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "y"}], "]"}]}], " ", "+", 
          " ", 
          RowBox[{"OMz", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"e1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "y"}], "]"}]}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], " ", "-", " ", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.780164904314496*^9, 3.780164907546674*^9}, 
   3.7801653685531178`*^9, {3.78016680411476*^9, 3.7801668042799673`*^9}, {
   3.780362922830865*^9, 3.780362931226569*^9}, {3.7808688468038263`*^9, 
   3.780868860907311*^9}, {3.7808693426750917`*^9, 3.780869356240794*^9}, {
   3.780873620361184*^9, 3.7808736369184713`*^9}, {3.780874030656898*^9, 
   3.780874030836547*^9}, {3.78087444430746*^9, 3.7808744444610233`*^9}, {
   3.780941508860097*^9, 3.780941509069193*^9}, {3.780953404205668*^9, 
   3.780953404339181*^9}},
 CellLabel->
  "In[3325]:=",ExpressionUUID->"d9b6da79-ef53-4de8-8114-8615a85789cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", "z"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", "*", "om", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"e1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], ",", "z"}], "]"}]}], " ", "+", 
          " ", 
          RowBox[{"OMz", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"e1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", "z"}], "]"}]}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], " ", "-", " ", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.7801649136327953`*^9, 3.780164916708845*^9}, 
   3.780165370471192*^9, {3.7801668044421387`*^9, 3.780166804565155*^9}, {
   3.7803629351906347`*^9, 3.78036294504386*^9}, {3.780868848021525*^9, 
   3.780868862393552*^9}, {3.780869341476787*^9, 3.780869357592895*^9}, {
   3.780873641299127*^9, 3.780873644443488*^9}, {3.780874032345042*^9, 
   3.7808740325165043`*^9}, {3.780874445472208*^9, 3.780874445596375*^9}, {
   3.780941509294512*^9, 3.780941509520352*^9}, {3.780953404483683*^9, 
   3.78095340464504*^9}},
 CellLabel->
  "In[3326]:=",ExpressionUUID->"978e3c34-59d0-4399-a937-7048957b1019"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Conjugate", "[", 
        RowBox[{"u1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "x"}], "]"}], "\[Rule]", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", "*", "om", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", 
              RowBox[{"e1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "x"}], "]"}]}], 
          " ", "+", " ", 
          RowBox[{"OMz", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", 
              RowBox[{"e1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "x"}], "]"}]}]}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], " ", "-", " ", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.7801649271080523`*^9, 3.780164929643194*^9}, 
   3.780165372465392*^9, {3.7801668047269373`*^9, 3.7801668048903112`*^9}, {
   3.78026210798582*^9, 3.7802621271902113`*^9}, {3.780362949400549*^9, 
   3.7803629575048933`*^9}, {3.7808688659061604`*^9, 3.780868871720356*^9}, {
   3.7808693326411047`*^9, 3.780869337853558*^9}, {3.780873653616177*^9, 
   3.7808736640686483`*^9}, {3.780874035134676*^9, 3.780874035299604*^9}, {
   3.780874446489005*^9, 3.7808744466174307`*^9}, {3.780941509719925*^9, 
   3.780941509939839*^9}, {3.780941560159451*^9, 3.780941560230337*^9}, {
   3.7809415973780622`*^9, 3.780941597441731*^9}, {3.78095340476727*^9, 
   3.7809534050501966`*^9}, {3.780968010882593*^9, 3.780968012263419*^9}},
 CellLabel->
  "In[3327]:=",ExpressionUUID->"a9dc4a3d-6dd6-449e-8b1b-0ebd065554b9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Conjugate", "[", 
        RowBox[{"u1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "y"}], "]"}], "\[Rule]", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", "*", "om", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", 
              RowBox[{"e1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "y"}], "]"}]}], 
          " ", "+", " ", 
          RowBox[{"OMz", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", 
              RowBox[{"e1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "y"}], "]"}]}]}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], " ", "-", " ", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.780164935952593*^9, 3.7801649456110687`*^9}, 
   3.780165375180685*^9, {3.7801668050498247`*^9, 3.7801668052065973`*^9}, {
   3.780262133001947*^9, 3.780262157853304*^9}, {3.7803629806263523`*^9, 
   3.780362990485025*^9}, {3.780868897813365*^9, 3.780868904615178*^9}, {
   3.780869323376383*^9, 3.780869330634082*^9}, {3.780873673506792*^9, 
   3.780873676900481*^9}, {3.780874037231737*^9, 3.78087403739285*^9}, {
   3.780874448418754*^9, 3.780874448553203*^9}, {3.780941510137003*^9, 
   3.780941510381732*^9}, {3.780941562004121*^9, 3.7809415620800953`*^9}, {
   3.7809415988778543`*^9, 3.78094159894626*^9}, {3.7809534052158546`*^9, 
   3.7809534053485327`*^9}, {3.780968013382304*^9, 3.78096801468464*^9}},
 CellLabel->
  "In[3328]:=",ExpressionUUID->"658254c2-0ba3-40a9-b199-16423a19d149"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Conjugate", "[", 
        RowBox[{"u1", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "z"}], "]"}], "\[Rule]", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"I", "*", "om", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", 
              RowBox[{"e1", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "z"}], "]"}]}], 
          " ", "+", " ", 
          RowBox[{"OMz", "*", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"Conjugate", "[", 
              RowBox[{"e1", "[", 
               RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "z"}], "]"}]}]}], 
         ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"om", "^", "2"}], " ", "-", " ", 
          RowBox[{"OMz", "^", "2"}]}], ")"}]}], ")"}]}]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.780164952516686*^9, 3.7801649600392313`*^9}, 
   3.7801653785471897`*^9, {3.7801668053635187`*^9, 3.780166805516629*^9}, {
   3.780262196085824*^9, 3.7802622166952763`*^9}, {3.7803629960384693`*^9, 
   3.7803630055889673`*^9}, {3.7808689068757267`*^9, 3.780868912010129*^9}, {
   3.780869292001732*^9, 3.780869319320736*^9}, {3.780873681592531*^9, 
   3.78087368531485*^9}, {3.7808740392812*^9, 3.780874039443036*^9}, {
   3.780874449459629*^9, 3.7808744495923*^9}, {3.7809415106039467`*^9, 
   3.780941510812468*^9}, {3.780941563807487*^9, 3.780941563907638*^9}, {
   3.7809416006334352`*^9, 3.780941600728428*^9}, {3.7809534054955072`*^9, 
   3.7809534056299057`*^9}, {3.7809680159613256`*^9, 3.780968017064496*^9}},
 CellLabel->
  "In[3329]:=",ExpressionUUID->"b08cf55a-03af-4326-a410-88a9d099379e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u1", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "x"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"I", "/", "om"}], ")"}], "*", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"e1", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "x"}], "]"}]}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.780164968689763*^9, 3.780164994721258*^9}, 
   3.7801653813992567`*^9, {3.780166805679343*^9, 3.780166805854722*^9}, {
   3.7803630115225267`*^9, 3.780363021908558*^9}, {3.780874046772346*^9, 
   3.780874046829751*^9}, {3.780874451312628*^9, 3.780874451439893*^9}, {
   3.780941511319647*^9, 3.780941511516184*^9}, {3.780953405771093*^9, 
   3.780953405924608*^9}, {3.7809683275913687`*^9, 3.780968338110466*^9}, {
   3.780968418624382*^9, 3.780968419857768*^9}},
 CellLabel->
  "In[3330]:=",ExpressionUUID->"a7b4e748-97b3-484f-981a-835079996bdc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u1", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "y"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"I", "/", "om"}], ")"}], "*", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"e1", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "y"}], "]"}]}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.780165012942753*^9, 3.780165014586856*^9}, 
   3.780165383286333*^9, {3.7801668060179768`*^9, 3.7801668061803093`*^9}, {
   3.7803630145149403`*^9, 3.7803630248779583`*^9}, {3.7808740489645863`*^9, 
   3.780874049046262*^9}, {3.780874452159091*^9, 3.78087445230902*^9}, {
   3.7809415117149153`*^9, 3.780941511911377*^9}, {3.7809534060749693`*^9, 
   3.7809534064698143`*^9}, {3.78096832841833*^9, 3.7809683416453533`*^9}, {
   3.780968411271501*^9, 3.7809684144605513`*^9}},
 CellLabel->
  "In[3331]:=",ExpressionUUID->"0e869802-8554-4ac4-a593-ea4d286a49b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"u1", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", "z"}], "]"}], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"I", "/", "om"}], ")"}], "*", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"e1", "[", 
         RowBox[{"[", "3", "]"}], "]"}], ",", "z"}], "]"}]}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.780165019604767*^9, 3.780165022232465*^9}, 
   3.780165385058425*^9, {3.7801668063530607`*^9, 3.780166806486494*^9}, {
   3.780363017806088*^9, 3.7803630279638367`*^9}, {3.780874051163589*^9, 
   3.780874051248423*^9}, {3.780874453160747*^9, 3.7808744532917852`*^9}, {
   3.780941512074394*^9, 3.78094151226196*^9}, {3.780953406634534*^9, 
   3.780953406757622*^9}, {3.780968329370461*^9, 3.780968345218615*^9}, {
   3.7809684063389072`*^9, 3.7809684080866213`*^9}},
 CellLabel->
  "In[3332]:=",ExpressionUUID->"9963373b-c9c6-4638-9135-303a65509871"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Conjugate", "[", 
        RowBox[{"u1", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "x"}], "]"}], "\[Rule]", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"I", "/", "om"}], ")"}], "*", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{"e1", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "x"}], "]"}]}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.780165029289021*^9, 3.780165030674717*^9}, 
   3.780165387760281*^9, {3.780166806648691*^9, 3.78016680679076*^9}, {
   3.780262237532247*^9, 3.7802622499725*^9}, {3.780363032217263*^9, 
   3.780363042574211*^9}, {3.780874052602714*^9, 3.780874052673913*^9}, {
   3.780874454082424*^9, 3.780874454227899*^9}, {3.780941512459982*^9, 
   3.780941512632112*^9}, {3.780941566267391*^9, 3.780941566350305*^9}, {
   3.7809416031525087`*^9, 3.780941603242897*^9}, {3.7809534068953114`*^9, 
   3.780953407031201*^9}, {3.780968018859098*^9, 3.780968022072236*^9}, {
   3.780968347743052*^9, 3.780968353335627*^9}, {3.7809683871693497`*^9, 
   3.7809683887435503`*^9}},
 CellLabel->
  "In[3333]:=",ExpressionUUID->"a594bfe2-c61a-4a21-891e-30fc6ac8d294"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Conjugate", "[", 
        RowBox[{"u1", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "y"}], "]"}], "\[Rule]", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"I", "/", "om"}], ")"}], "*", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{"e1", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "y"}], "]"}]}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.780165036498783*^9, 3.780165041480008*^9}, 
   3.78016538952671*^9, {3.78016680695271*^9, 3.780166807082838*^9}, {
   3.780262253005005*^9, 3.780262264335919*^9}, {3.78036303498903*^9, 
   3.780363046213232*^9}, {3.78087405420296*^9, 3.7808740542655077`*^9}, {
   3.780874454990816*^9, 3.780874455126856*^9}, {3.780941512813368*^9, 
   3.780941513003665*^9}, {3.7809415677072906`*^9, 3.780941567769094*^9}, {
   3.780941605016045*^9, 3.78094160510436*^9}, {3.780953407180258*^9, 
   3.7809534073133917`*^9}, {3.780968019811884*^9, 3.78096802274301*^9}, {
   3.780968354789159*^9, 3.780968361125554*^9}, {3.7809683930122232`*^9, 
   3.7809683955397377`*^9}},
 CellLabel->
  "In[3334]:=",ExpressionUUID->"1748ad08-2448-43eb-8d8d-3dc0eb7d8522"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pf", "=", 
   RowBox[{"pf", "/.", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Conjugate", "[", 
        RowBox[{"u1", "[", 
         RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "z"}], "]"}], "\[Rule]", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{"q", "/", "m"}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"I", "/", "om"}], ")"}], "*", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Conjugate", "[", 
         RowBox[{"e1", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "z"}], "]"}]}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.780165046428611*^9, 3.780165050600894*^9}, 
   3.780165391422283*^9, {3.780166807265505*^9, 3.780166807404001*^9}, {
   3.780262266368187*^9, 3.780262278794261*^9}, {3.780363038027342*^9, 
   3.780363049414707*^9}, {3.780874055558001*^9, 3.780874055630562*^9}, {
   3.7808744558683567`*^9, 3.780874455983035*^9}, {3.78094151317632*^9, 
   3.780941513391597*^9}, {3.7809415704673147`*^9, 3.780941570543539*^9}, {
   3.7809416063092813`*^9, 3.780941606400792*^9}, {3.780953407453287*^9, 
   3.780953407598249*^9}, {3.7809680207594357`*^9, 3.780968023410643*^9}, {
   3.780968356381402*^9, 3.7809683675057592`*^9}, {3.780968398796075*^9, 
   3.780968401424109*^9}},
 CellLabel->
  "In[3335]:=",ExpressionUUID->"0ca5e834-7d11-494b-a2a8-fba6c6715169"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Simplify", " ", "terms", " ", "in", " ", "pf", " ", 
    RowBox[{"expression", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Pond", "=", 
    RowBox[{"Simplify", "[", "pf", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.780165061532406*^9, 3.7801650725598307`*^9}, 
   3.780165394497705*^9, {3.7801668076117773`*^9, 3.7801668079365177`*^9}, {
   3.780167074794524*^9, 3.7801670975862827`*^9}, {3.780263313256194*^9, 
   3.780263315284225*^9}, {3.780941514125684*^9, 3.780941515018757*^9}, {
   3.780953407740837*^9, 3.780953420599628*^9}, 3.781044520124254*^9},
 CellLabel->
  "In[3336]:=",ExpressionUUID->"94f90304-56e5-421a-81ba-6671efdb6c69"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Delete", " ", "semicolon", " ", "to", " ", "print", " ", "in", " ", 
    "matrix", " ", 
    RowBox[{"form", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Pond", "//", "MatrixForm"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.780165093915262*^9, 3.780165101077026*^9}, 
   3.7801668088334293`*^9, {3.780167086863899*^9, 3.780167098784554*^9}, {
   3.780167461832036*^9, 3.780167478309615*^9}, {3.780263317732739*^9, 
   3.78026331882545*^9}, {3.780265906955185*^9, 3.780265919647007*^9}, {
   3.78036240933536*^9, 3.780362410037393*^9}, 3.780363498155921*^9, 
   3.780941515818828*^9, {3.7809534108598557`*^9, 3.780953427507407*^9}},
 CellLabel->
  "In[3337]:=",ExpressionUUID->"198acbab-40c7-4855-ade0-89fe8b8b298a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Calculate", " ", "full", " ", "expression"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"fullpond", " ", "=", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"Re", "[", "pf", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "Expand", " ", "to", " ", "take", " ", "the", " ", "real", " ", "part"}],
      ",", " ", 
     RowBox[{"simplify", " ", 
      RowBox[{"again", "."}]}]}], " ", "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.780167220609006*^9, 3.780167270046369*^9}, {
   3.780167427745637*^9, 3.780167450973192*^9}, {3.780262582824369*^9, 
   3.780262586278315*^9}, {3.780262656000802*^9, 3.780262660085791*^9}, {
   3.780265975418311*^9, 3.780265985457117*^9}, {3.7808600269531193`*^9, 
   3.7808600306046267`*^9}, {3.78087470389671*^9, 3.7808747090118647`*^9}, {
   3.780876090684564*^9, 3.780876108835587*^9}, 3.780876161893421*^9, 
   3.78094139789777*^9, {3.7809534447622843`*^9, 3.7809534477045183`*^9}, {
   3.7810436754139843`*^9, 3.781043681832342*^9}, {3.781044403088135*^9, 
   3.7810444045204153`*^9}},
 CellLabel->
  "In[3338]:=",ExpressionUUID->"88e86edb-afa8-48f4-93f0-c3c634746c55"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Pond", " ", "=", " ", 
   RowBox[{
    RowBox[{"ComplexExpand", "[", "fullpond", "]"}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Pond", "//", "MatrixForm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7801672753703737`*^9, 3.780167287716066*^9}, {
   3.78016733182421*^9, 3.780167394478181*^9}, {3.7802659886231318`*^9, 
   3.78026599198097*^9}, {3.7808600323763742`*^9, 3.780860042362452*^9}, {
   3.780860144759411*^9, 3.7808601474629097`*^9}, {3.7808747156134357`*^9, 
   3.780874716039419*^9}, {3.7808749344216213`*^9, 3.780874937415922*^9}, {
   3.780875007255102*^9, 3.780875012907199*^9}, {3.780875498334859*^9, 
   3.7808755328266983`*^9}, {3.780876027385247*^9, 3.780876062386313*^9}, 
   3.780941423537758*^9, {3.780953448904455*^9, 3.780953453562029*^9}, {
   3.7810437487177353`*^9, 3.781043751000145*^9}, {3.7810442784146023`*^9, 
   3.781044279135655*^9}},
 CellLabel->
  "In[3339]:=",ExpressionUUID->"7915ebe8-7cb9-4bef-be6a-b2b3914228ce"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Set", " ", "fields", " ", "or", " ", "field", " ", "derivaties", " ", 
    "to", " ", "zero", " ", "depending", " ", "on", " ", "the", " ", 
    "desired", " ", "polarisation", " ", "and", " ", "solution", " ", 
    RowBox[{"direction", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Pond", " ", "=", " ", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"e1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "x"}], "]"}], "\[Rule]", " ", 
       "0"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Pond", " ", "=", " ", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"e1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "y"}], "]"}], "\[Rule]", " ", 
       "0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pond", " ", "=", " ", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"e1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "z"}], "]"}], "\[Rule]", " ", 
       "0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pond", " ", "=", " ", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"e1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "x"}], "]"}], "\[Rule]", " ", 
       "0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pond", " ", "=", " ", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"e1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "y"}], "]"}], "\[Rule]", " ", 
       "0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pond", " ", "=", " ", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"e1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "z"}], "]"}], "\[Rule]", " ", 
       "0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pond", " ", "=", " ", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"e1", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "\[Rule]", "0"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pond", " ", "=", " ", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"e1", "[", 
        RowBox[{"[", "2", "]"}], "]"}], "\[Rule]", "0"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Pond", " ", "=", " ", 
      RowBox[{"Pond", "/.", 
       RowBox[{
        RowBox[{"e1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "\[Rule]", "0"}]}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pond", " ", "=", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"e1", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "x"}], "]"}], "\[Rule]", 
       "0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pond", " ", "=", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"e1", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "y"}], "]"}], "\[Rule]", 
       "0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Pond", " ", "=", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"e1", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "z"}], "]"}], "\[Rule]", 
       "0"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Simplify", "[", "Pond", "]"}], "//", "MatrixForm"}]}]}]], "Input",\

 CellChangeTimes->{{3.780362151093371*^9, 3.7803622105196466`*^9}, {
  3.780362250987667*^9, 3.780362277832157*^9}, {3.780362488489073*^9, 
  3.780362490688167*^9}, {3.780363239691557*^9, 3.780363278944757*^9}, {
  3.78036334496354*^9, 3.780363400946251*^9}, {3.780363503671359*^9, 
  3.7803635266867447`*^9}, {3.780698449879496*^9, 3.780698451880718*^9}, {
  3.7808582844776573`*^9, 3.780858303647949*^9}, {3.780859859233622*^9, 
  3.780859861038578*^9}, {3.7808599048272*^9, 3.7808599102997723`*^9}, {
  3.78085995829886*^9, 3.780859963488748*^9}, {3.781043117592451*^9, 
  3.7810431402612*^9}, {3.781043425712816*^9, 3.781043427943008*^9}, {
  3.781043742829256*^9, 3.781043744709978*^9}, {3.781043877477273*^9, 
  3.781043919925528*^9}, {3.781044182295651*^9, 3.781044215283783*^9}, {
  3.7810442598379374`*^9, 3.781044390547901*^9}, {3.781292773111945*^9, 
  3.7812928135355*^9}},
 CellLabel->
  "In[3341]:=",ExpressionUUID->"d0ef0898-79e0-4ecb-a37b-33fc19bd3e4c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{"n", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["om", "2"], "+", 
            SuperscriptBox["OMz", "2"]}], ")"}], " ", 
          SuperscriptBox["q", "2"], " ", 
          RowBox[{"e1x", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["e1x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
         RowBox[{"2", " ", "m", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["om", "2"], "-", 
             SuperscriptBox["OMz", "2"]}], ")"}], "2"]}]]}]},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.78104376142157*^9, 3.781043786230606*^9}, 
   3.781043830845784*^9, 3.781043937247789*^9, 3.781044246757695*^9, {
   3.7810442769482822`*^9, 3.781044280356893*^9}, 3.781044344372283*^9, 
   3.781044504308959*^9, 3.7812927546986523`*^9, 3.781292825569499*^9},
 CellLabel->
  "Out[3351]//MatrixForm=",ExpressionUUID->"9886a267-d582-48ef-bd17-\
dd0b500d006f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "OR", " ", "Set", " ", "derivatives", " ", "x", " ", "and", " ", "y", " ", 
    "to", " ", "be", " ", "some", " ", "constant", " ", "value"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Pond", " ", "=", " ", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"e1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "x"}], "]"}], "\[Rule]", " ", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Lambda]", ",", "x"}], "]"}], "*", 
        RowBox[{"e1", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Pond", " ", "=", " ", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"e1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "y"}], "]"}], "\[Rule]", " ", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Lambda]", ",", "y"}], "]"}], "*", 
        RowBox[{"e1", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Pond", " ", "=", " ", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"e1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "x"}], "]"}], 
       "\[Rule]", " ", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Lambda]", ",", "x"}], "]"}], "*", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"e1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Pond", " ", "=", " ", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"e1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "y"}], "]"}], 
       "\[Rule]", " ", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Lambda]", ",", "y"}], "]"}], "*", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"e1", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}]}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Pond", " ", "=", " ", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"e1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "x"}], "]"}], "\[Rule]", " ", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Lambda]", ",", "x"}], "]"}], "*", 
        RowBox[{"e1", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Pond", " ", "=", " ", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"e1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], ",", "y"}], "]"}], "\[Rule]", " ", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Lambda]", ",", "y"}], "]"}], "*", 
        RowBox[{"e1", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Pond", " ", "=", " ", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"e1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "x"}], "]"}], 
       "\[Rule]", " ", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Lambda]", ",", "x"}], "]"}], "*", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"e1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Pond", " ", "=", " ", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"e1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "y"}], "]"}], 
       "\[Rule]", " ", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Lambda]", ",", "y"}], "]"}], "*", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"e1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "]"}]}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Pond", "=", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"e1", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "x"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Lambda]", ",", "x"}], "]"}], "*", 
        RowBox[{"e1", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Pond", "=", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"e1", "[", 
          RowBox[{"[", "3", "]"}], "]"}], ",", "y"}], "]"}], "\[Rule]", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Lambda]", ",", "y"}], "]"}], "*", 
        RowBox[{"e1", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Pond", "=", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"e1", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "x"}], "]"}], 
       "\[Rule]", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Lambda]", ",", "x"}], "]"}], "*", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"e1", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Pond", "=", 
     RowBox[{"Pond", "/.", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"Conjugate", "[", 
          RowBox[{"e1", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "y"}], "]"}], 
       "\[Rule]", 
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"\[Lambda]", ",", "y"}], "]"}], "*", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"e1", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "]"}]}]}]}]}], ";"}], 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.780266150549752*^9, 3.780266207022388*^9}, {
   3.780266238625614*^9, 3.780266261898077*^9}, {3.7802663037465887`*^9, 
   3.780266305241919*^9}, {3.780266338865219*^9, 3.7802663541582413`*^9}, {
   3.7802664001525393`*^9, 3.7802664163455133`*^9}, {3.780266510999591*^9, 
   3.780266517254011*^9}, {3.7802666823841248`*^9, 3.780266801461013*^9}, {
   3.7803635284877357`*^9, 3.780363539246654*^9}, {3.78085831822152*^9, 
   3.780858423464254*^9}, 3.780858465564259*^9, {3.7808602469121103`*^9, 
   3.7808602501371098`*^9}, {3.781044618279984*^9, 3.781044619909134*^9}},
 CellLabel->
  "In[3352]:=",ExpressionUUID->"7a60b188-8e4b-4feb-9d4b-728ee29766e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Simplify", "[", "Pond", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.7802668368321543`*^9, 3.780266856275179*^9}, {
  3.780363509079207*^9, 3.780363534777948*^9}, {3.780858322253784*^9, 
  3.7808583241855383`*^9}},
 CellLabel->
  "In[3353]:=",ExpressionUUID->"d124cf90-f8a6-4abc-ba11-a815bb5c21e5"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"-", 
        FractionBox[
         RowBox[{"n", " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["om", "2"], "+", 
            SuperscriptBox["OMz", "2"]}], ")"}], " ", 
          SuperscriptBox["q", "2"], " ", 
          RowBox[{"e1x", "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["e1x", 
            TagBox[
             RowBox[{"(", 
              RowBox[{"1", ",", "0", ",", "0"}], ")"}],
             Derivative],
            MultilineFunction->None], "[", 
           RowBox[{"x", ",", "y", ",", "z"}], "]"}]}], 
         RowBox[{"2", " ", "m", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["om", "2"], "-", 
             SuperscriptBox["OMz", "2"]}], ")"}], "2"]}]]}]},
      {"0"},
      {"0"}
     },
     GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.780858447758615*^9, 3.78085847537062*^9}, 
   3.780859845340457*^9, {3.7808599155015173`*^9, 3.78085992246758*^9}, 
   3.780859968500161*^9, {3.780860218279832*^9, 3.780860256299836*^9}, 
   3.7808603024722033`*^9, {3.7808603655230722`*^9, 3.780860384951021*^9}, 
   3.7808606210088387`*^9, 3.780860691220029*^9, 3.7808616743210773`*^9, {
   3.780869452903677*^9, 3.780869479142043*^9}, 3.780871697821733*^9, {
   3.780871771791449*^9, 3.7808718169503107`*^9}, 3.780873916625692*^9, 
   3.780874060177787*^9, 3.780874469171426*^9, 3.780874922500287*^9, 
   3.7808753745374937`*^9, {3.780875474277637*^9, 3.780875526832357*^9}, 
   3.7808756075137777`*^9, 3.780875777729895*^9, 3.780875993920517*^9, 
   3.780876097544375*^9, 3.7808761675518637`*^9, 3.780941579737924*^9, 
   3.780941611339169*^9, 3.780950913450375*^9, {3.780953458507103*^9, 
   3.780953474761507*^9}, 3.780967912281296*^9, 3.780968028694797*^9, 
   3.780968073969398*^9, 3.780968110100829*^9, {3.7809682493175583`*^9, 
   3.7809682695869703`*^9}, 3.780968458218193*^9, 3.780968604545106*^9, {
   3.7810430773087*^9, 3.781043087348144*^9}, 3.781043145108265*^9, 
   3.781043194397188*^9, 3.781043276995846*^9, 3.781043336752166*^9, 
   3.781043409715403*^9, 3.781043440317309*^9, 3.781043519009198*^9, {
   3.7810436061174803`*^9, 3.7810436125106363`*^9}, 3.781043761528112*^9, 
   3.781043830955977*^9, 3.781043937332162*^9, 3.781044504426817*^9, 
   3.781292754759428*^9, 3.78129282563183*^9},
 CellLabel->
  "Out[3353]//MatrixForm=",ExpressionUUID->"e5b16ce0-52fd-4da0-a597-\
4dedb19b6935"]
}, Open  ]]
},
WindowSize->{830, 997},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 4099, 92, 367, "Input",ExpressionUUID->"7eaf9c2a-9f68-4c56-807e-f3e67ea9f3a6"],
Cell[4682, 116, 2580, 39, 77, "Output",ExpressionUUID->"e9e11d67-3cd2-4c4c-aa57-9222d252d6c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7299, 160, 582, 11, 73, "Input",ExpressionUUID->"9c880cf5-f9a8-49f6-a8b6-5e172fd8bb9d"],
Cell[7884, 173, 2587, 39, 77, "Output",ExpressionUUID->"d3a6ee5c-e5d9-40e2-94ed-230624306695"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10508, 217, 435, 9, 52, "Input",ExpressionUUID->"d4fbffe0-5838-47d6-b9da-91f57e12328e"],
Cell[10946, 228, 3408, 54, 182, "Output",ExpressionUUID->"5505ae73-ab95-496d-8ab0-8aae14676f92"]
}, Open  ]],
Cell[14369, 285, 522, 14, 73, "Input",ExpressionUUID->"c3dd8c2e-a7cd-4af1-8ddc-0f154bfeea1d"],
Cell[14894, 301, 2922, 63, 136, "Input",ExpressionUUID->"3976b533-f7a2-43a4-8749-dc73a2d5215b"],
Cell[17819, 366, 401, 9, 30, "Input",ExpressionUUID->"94ab76cc-d1be-4158-baa6-98e4a552c4a5"],
Cell[18223, 377, 1651, 29, 30, "Input",ExpressionUUID->"93cc711f-79f2-4ec3-9237-a14f23421afe"],
Cell[19877, 408, 565, 16, 52, "Input",ExpressionUUID->"535a0ab3-2ccf-4273-945b-84117760b7ba"],
Cell[20445, 426, 336, 8, 30, "Input",ExpressionUUID->"1ef227e6-06be-40a9-b7b0-8bd7df6d9c69"],
Cell[20784, 436, 1001, 23, 52, "Input",ExpressionUUID->"44bbbc6c-d9fd-4e3f-b056-c2820a3e5dd4"],
Cell[21788, 461, 805, 17, 30, "Input",ExpressionUUID->"1909b70a-37c9-49c2-b8d7-5302a24a9802"],
Cell[22596, 480, 656, 15, 30, "Input",ExpressionUUID->"98a40c7b-a283-40c5-90d0-a8e3177dccd3"],
Cell[CellGroupData[{
Cell[23277, 499, 700, 14, 73, "Input",ExpressionUUID->"61a3ef56-99d5-4128-b306-9478a9bd9bfc"],
Cell[23980, 515, 2566, 38, 34, "Output",ExpressionUUID->"8ba25516-587d-44bb-b238-fbf6e119711d"]
}, Open  ]],
Cell[26561, 556, 1096, 23, 73, "Input",ExpressionUUID->"64979cd6-eb9c-4ff5-9895-8d36bf79b1cf"],
Cell[27660, 581, 882, 21, 52, "Input",ExpressionUUID->"d72ba8ed-f085-4e2a-a4a1-a2849aae6a50"],
Cell[28545, 604, 1022, 27, 73, "Input",ExpressionUUID->"2b8906ed-7b61-4955-957d-2049d6bcffac"],
Cell[CellGroupData[{
Cell[29592, 635, 1014, 18, 73, "Input",ExpressionUUID->"f2e7b075-ad6f-4572-b205-806ac39c6bb9"],
Cell[30609, 655, 2904, 43, 34, "Output",ExpressionUUID->"24216c2e-941d-4449-a41c-a9af88f5c378"]
}, Open  ]],
Cell[33528, 701, 681, 18, 52, "Input",ExpressionUUID->"e8e7c7ba-a5c0-4909-89f0-9bd6ecf59aa7"],
Cell[34212, 721, 1432, 25, 52, "Input",ExpressionUUID->"cfff2724-20ac-4e42-bad1-66be53cca707"],
Cell[CellGroupData[{
Cell[35669, 750, 525, 10, 52, "Input",ExpressionUUID->"8be182c7-0bfc-4a53-930a-d8bcf086818b"],
Cell[36197, 762, 2606, 38, 34, "Output",ExpressionUUID->"31618797-fbf1-43fe-95b5-65dfdb325409"]
}, Open  ]],
Cell[38818, 803, 1231, 23, 73, "Input",ExpressionUUID->"84a177a2-49c8-4bd8-aa5e-425c4ae83071"],
Cell[CellGroupData[{
Cell[40074, 830, 448, 10, 52, "Input",ExpressionUUID->"8db26c2f-7136-4e48-b582-5461923f79e1"],
Cell[40525, 842, 2593, 39, 34, "Output",ExpressionUUID->"b0fd6506-8ca7-4de4-ad04-4ae44c715edc"]
}, Open  ]],
Cell[43133, 884, 1397, 32, 73, "Input",ExpressionUUID->"cdb0caa4-ac28-45ad-a62d-5df22205ad87"],
Cell[44533, 918, 588, 16, 30, "Input",ExpressionUUID->"36843598-1922-423d-a721-290937657c9e"],
Cell[CellGroupData[{
Cell[45146, 938, 626, 12, 52, "Input",ExpressionUUID->"b816106d-a944-4f8c-8ebc-0433385defbc"],
Cell[45775, 952, 2569, 37, 34, "Output",ExpressionUUID->"b7bef631-d1d3-4792-af44-d6ef37f8222b"]
}, Open  ]],
Cell[48359, 992, 1418, 38, 52, "Input",ExpressionUUID->"b53729de-012a-425e-97a1-1d30b28c7298"],
Cell[CellGroupData[{
Cell[49802, 1034, 634, 13, 52, "Input",ExpressionUUID->"d9bb899d-d67b-4bdb-a69d-9b846fd81806"],
Cell[50439, 1049, 2616, 38, 34, "Output",ExpressionUUID->"f892ad3d-af55-450e-9ca7-f394aa473ee1"]
}, Open  ]],
Cell[53070, 1090, 2818, 77, 136, "Input",ExpressionUUID->"ace7229e-0e69-4b00-b02c-6fa717a82c90"],
Cell[55891, 1169, 1460, 35, 30, "Input",ExpressionUUID->"5e607b55-1c22-483c-9caa-0f1177206757"],
Cell[57354, 1206, 2798, 72, 157, "Input",ExpressionUUID->"8c4516e2-e09b-408f-a8b0-453848a81627"],
Cell[60155, 1280, 1594, 38, 73, "Input",ExpressionUUID->"c4cdf3a4-bab6-4f9f-8730-65d2aa9499a5"],
Cell[61752, 1320, 1689, 39, 73, "Input",ExpressionUUID->"1f0a54b3-e0c3-4d33-a6c3-f00245cf6f99"],
Cell[63444, 1361, 1190, 26, 30, "Input",ExpressionUUID->"93525c6a-92e0-4da6-9c52-0f211d92b860"],
Cell[64637, 1389, 968, 24, 73, "Input",ExpressionUUID->"943029c4-5f0f-4069-9747-f8328c725320"],
Cell[65608, 1415, 1587, 42, 30, "Input",ExpressionUUID->"4dece9a2-067d-4d29-9771-7f67308b6324"],
Cell[67198, 1459, 1979, 49, 94, "Input",ExpressionUUID->"f93aa26e-8936-451d-8c4a-a8a5c1aa51b9"],
Cell[69180, 1510, 1540, 41, 30, "Input",ExpressionUUID->"7c94deda-3865-4ef5-a356-f1dd5bc7e76a"],
Cell[70723, 1553, 1638, 42, 30, "Input",ExpressionUUID->"7832ce6a-86e3-41eb-ade7-a0f17df334e8"],
Cell[72364, 1597, 1924, 48, 94, "Input",ExpressionUUID->"1e3d5d02-3c1b-4b6b-8e36-4477734f6777"],
Cell[74291, 1647, 1881, 48, 94, "Input",ExpressionUUID->"944c28c3-0ad5-45cf-b124-bf72553c6023"],
Cell[76175, 1697, 1595, 42, 30, "Input",ExpressionUUID->"c57a25c4-53b9-4999-8fc8-7496b1347e88"],
Cell[77773, 1741, 1596, 42, 30, "Input",ExpressionUUID->"d9b6da79-ef53-4de8-8114-8615a85789cf"],
Cell[79372, 1785, 1592, 42, 30, "Input",ExpressionUUID->"978e3c34-59d0-4399-a937-7048957b1019"],
Cell[80967, 1829, 1946, 48, 94, "Input",ExpressionUUID->"a9dc4a3d-6dd6-449e-8b1b-0ebd065554b9"],
Cell[82916, 1879, 1939, 48, 94, "Input",ExpressionUUID->"658254c2-0ba3-40a9-b199-16423a19d149"],
Cell[84858, 1929, 1945, 48, 94, "Input",ExpressionUUID->"b08cf55a-03af-4326-a410-88a9d099379e"],
Cell[86806, 1979, 1091, 27, 30, "Input",ExpressionUUID->"a7b4e748-97b3-484f-981a-835079996bdc"],
Cell[87900, 2008, 1103, 27, 30, "Input",ExpressionUUID->"0e869802-8554-4ac4-a593-ea4d286a49b3"],
Cell[89006, 2037, 1094, 27, 30, "Input",ExpressionUUID->"9963373b-c9c6-4638-9135-303a65509871"],
Cell[90103, 2066, 1379, 33, 30, "Input",ExpressionUUID->"a594bfe2-c61a-4a21-891e-30fc6ac8d294"],
Cell[91485, 2101, 1378, 33, 30, "Input",ExpressionUUID->"1748ad08-2448-43eb-8d8d-3dc0eb7d8522"],
Cell[92866, 2136, 1383, 33, 30, "Input",ExpressionUUID->"0ca5e834-7d11-494b-a2a8-fba6c6715169"],
Cell[94252, 2171, 752, 14, 73, "Input",ExpressionUUID->"94f90304-56e5-421a-81ba-6671efdb6c69"],
Cell[95007, 2187, 801, 16, 52, "Input",ExpressionUUID->"198acbab-40c7-4855-ade0-89fe8b8b298a"],
Cell[95811, 2205, 1321, 30, 115, "Input",ExpressionUUID->"88e86edb-afa8-48f4-93f0-c3c634746c55"],
Cell[97135, 2237, 1023, 19, 52, "Input",ExpressionUUID->"7915ebe8-7cb9-4bef-be6a-b2b3914228ce"],
Cell[CellGroupData[{
Cell[98183, 2260, 4701, 130, 325, "Input",ExpressionUUID->"d0ef0898-79e0-4ecb-a37b-33fc19bd3e4c"],
Cell[102887, 2392, 1755, 49, 102, "Output",ExpressionUUID->"9886a267-d582-48ef-bd17-dd0b500d006f"]
}, Open  ]],
Cell[104657, 2444, 6789, 186, 283, "Input",ExpressionUUID->"7a60b188-8e4b-4feb-9d4b-728ee29766e5"],
Cell[CellGroupData[{
Cell[111471, 2634, 349, 7, 30, "Input",ExpressionUUID->"d124cf90-f8a6-4abc-ba11-a815bb5c21e5"],
Cell[111823, 2643, 2959, 66, 102, "Output",ExpressionUUID->"e5b16ce0-52fd-4da0-a597-4dedb19b6935"]
}, Open  ]]
}
]
*)

